<?php
 class xmlExporter implements iXmlExporter {const VERSION = "2.0";protected static $ROOT_PAGE_TYPE_ID;protected $source_id, $source_name;protected $files, $types, $langs, $domains, $templates, $elements, $branches, $objects, $restrictions, $registry, $data_types, $directories;protected $exported_files = array(), $exported_types = array(), $exported_langs = array(), $exported_domains = array(), $exported_templates = array(), $exported_elements = array(), $exported_objects = array(), $exported_restrictions = array(), $exported_registry_items = array(), $restricted_fields = array(), $exported_data_types = array(), $exported_dirs = array();protected $limit, $position = 0, $break = false;protected $translator;protected $destination;protected $completed = false;protected $doc;protected $root;protected $meta_container, $files_container, $types_container, $data_types_container, $pages_container, $objects_container, $relations_container, $restrictions_container, $registry_container, $dirs_container, $hierarchy_container;protected $export_log = array();protected $showAllFields = false;protected $ignoreRelations = false;protected $saveRelations = array();protected $oldGetLinks = NULL;public function __construct($vaf721e88e6c0a612be51c329cb2bc12a, $vd80c2a24a1dcebf784b89d42f66190a2 = false) {$this->relations = umiImportRelations::getInstance();$this->source_name = $vaf721e88e6c0a612be51c329cb2bc12a;$this->source_id = $this->relations->addNewSource($vaf721e88e6c0a612be51c329cb2bc12a);$this->limit = is_numeric($vd80c2a24a1dcebf784b89d42f66190a2) ? $vd80c2a24a1dcebf784b89d42f66190a2 : false;self::$ROOT_PAGE_TYPE_ID = umiObjectTypesCollection::getInstance()->getTypeIdByGUID('root-pages-type');}public function setIgnoreRelations($v621ddfd2ea41b75c6051189a7a012196 = array()) {$this->ignoreRelations = true;$this->saveRelations = $v621ddfd2ea41b75c6051189a7a012196;}public function setShowAllFields($v999429990f5610353c3b2ccfd54b5ad4 = false) {$this->showAllFields = $v999429990f5610353c3b2ccfd54b5ad4;}public function getExportLog() {return $this->export_log;}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $v78e731027d8fd50ed642340b7c9a63b3 . "\n\r";else $this->export_log[] = $v78e731027d8fd50ed642340b7c9a63b3;}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $vcb5e100e5a9a3e7f6d1fd97512215282 . "\n\r";else $this->export_log[] = "<font style='color:red''>" . $vcb5e100e5a9a3e7f6d1fd97512215282 . "</font>";}protected function saveState () {if (file_exists(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name)) && $this->break === false) {unlink(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name));}if ($this->break === true) {$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_types, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_types[$v2063c1608d6e0baf80249c42e2be5804]);}$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_elements, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_elements[$v2063c1608d6e0baf80249c42e2be5804]);}$v14f802e1fba977727845e8872c1743a7 = array_keys($this->exported_objects, 'found');foreach ($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {unset($this->exported_objects[$v2063c1608d6e0baf80249c42e2be5804]);}$vf1f713c9e000f5d3f280adbd124df4f5 = array(     'exported_files' => $this->exported_files,     'exported_types' => $this->exported_types,     'exported_langs' => $this->exported_langs,     'exported_domains' => $this->exported_domains,     'exported_templates' => $this->exported_templates,     'exported_elements' => $this->exported_elements,     'exported_objects' => $this->exported_objects,     'restricted_fields' =>$this->restricted_fields,     'restrictions' => $this->restrictions,     'exported_restrictions' => $this->exported_restrictions,     'exported_registry_items'=> $this->exported_registry_items,     'exported_data_types'=> $this->exported_data_types,     'exported_dirs'=> $this->exported_dirs    );file_put_contents(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name),  serialize($vf1f713c9e000f5d3f280adbd124df4f5));}}public function addElements($v6a7f245843454cf4f28ad7c5e2572aa2) {foreach ($v6a7f245843454cf4f28ad7c5e2572aa2 as $v65c10911d8b8591219a21ebacf46da01) {if ($v65c10911d8b8591219a21ebacf46da01 instanceof umiHierarchyElement) $v65c10911d8b8591219a21ebacf46da01 = $v65c10911d8b8591219a21ebacf46da01->getId();$this->elements[] = $v65c10911d8b8591219a21ebacf46da01;}}public function addBranches($v92ec19ffde05e15769b1bb3ee05ad745) {foreach ($v92ec19ffde05e15769b1bb3ee05ad745 as $v65c10911d8b8591219a21ebacf46da01) {if ($v65c10911d8b8591219a21ebacf46da01 instanceof umiHierarchyElement) $v65c10911d8b8591219a21ebacf46da01 = $v65c10911d8b8591219a21ebacf46da01->getId();$this->branches[] = $v65c10911d8b8591219a21ebacf46da01;}}public function addObjects($v5891da2d64975cae48d175d1e001f5da) {foreach ($v5891da2d64975cae48d175d1e001f5da as $vbe8f80182e0c983916da7338c2c1c040) {if ($vbe8f80182e0c983916da7338c2c1c040 instanceof umiObject) $vbe8f80182e0c983916da7338c2c1c040 = $vbe8f80182e0c983916da7338c2c1c040->getId();if ($vbe8f80182e0c983916da7338c2c1c040) $this->objects[] = $vbe8f80182e0c983916da7338c2c1c040;}}public function addTypes($vd14a8022b085f9ef19d479cbdd581127) {foreach ($vd14a8022b085f9ef19d479cbdd581127 as $v599dcce2998a6b40b1e38e8c6006cb0a) {if ($v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) $v599dcce2998a6b40b1e38e8c6006cb0a = $v599dcce2998a6b40b1e38e8c6006cb0a->getId();$this->types[] = $v599dcce2998a6b40b1e38e8c6006cb0a;}}public function addRestrictions($v81e12dac658cfd4c590486dd6f7523cf) {foreach ($v81e12dac658cfd4c590486dd6f7523cf as $v3dadfaeb46ec74762b37de11fea7605c) {if ($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) $v3dadfaeb46ec74762b37de11fea7605c = $v3dadfaeb46ec74762b37de11fea7605c->getId();$this->restrictions[] = $v3dadfaeb46ec74762b37de11fea7605c;}}public function addRegistry($v13872c0118a4316afd1e99295017d654 = array()) {foreach ($v13872c0118a4316afd1e99295017d654 as $vd6fe1d0be6347b8ef2427fa629c04485) {$this->registry[] = $vd6fe1d0be6347b8ef2427fa629c04485;}}public function setDestination($v6990a54322d9232390a784c5c9247dd6) {if (!is_dir($v6990a54322d9232390a784c5c9247dd6)) {$this->reportError("Destination folder does not exist");return false;}$this->destination = $v6990a54322d9232390a784c5c9247dd6;}public function addFiles($v04e502ffc79d50c43b2400a707036667 = array()) {foreach ($v04e502ffc79d50c43b2400a707036667 as $v1910059f421bfea36ecd0274f22185ad) {if (is_file($v1910059f421bfea36ecd0274f22185ad)) $this->files[] = new umiFile($v1910059f421bfea36ecd0274f22185ad);else {$this->reportError("File {$v1910059f421bfea36ecd0274f22185ad} doesn't exist");}}}public function addDirs($v04e502ffc79d50c43b2400a707036667 = array()) {foreach ($v04e502ffc79d50c43b2400a707036667 as $v1910059f421bfea36ecd0274f22185ad) {if (is_dir($v1910059f421bfea36ecd0274f22185ad)) $this->directories[] = new umiDirectory($v1910059f421bfea36ecd0274f22185ad);else {$this->reportError("Folder {$v1910059f421bfea36ecd0274f22185ad} doesn't exist");}}}public function addDomains($ve4e46deb7f9cc58c7abfb32e5570b6f3 = array()) {foreach ($ve4e46deb7f9cc58c7abfb32e5570b6f3 as $vad5f82e879a9c5d6b5b442eb37e50551) {if($vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) $this->domains[] = $vad5f82e879a9c5d6b5b442eb37e50551;}}public function addLangs($v5a05866850c28651fe234659f6c92ada = array()) {foreach ($v5a05866850c28651fe234659f6c92ada as $v7572559ca86e781ba8fe8073a0b725c6) {if($v7572559ca86e781ba8fe8073a0b725c6 instanceof lang) $v7572559ca86e781ba8fe8073a0b725c6 = $v7572559ca86e781ba8fe8073a0b725c6->getId();$this->langs[] = $v7572559ca86e781ba8fe8073a0b725c6;}}public function addTemplates($vfed36e93a0509e20f2dc96cbbd85b678 = array()) {foreach ($vfed36e93a0509e20f2dc96cbbd85b678 as $v66f6181bcb4cff4cd38fbc804a036db6) {if($v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) $this->templates[] = $v66f6181bcb4cff4cd38fbc804a036db6;}}public function addDataTypes($v276d269c22fa4df82a9c11c55c2ff5d0 = array()) {foreach ($v276d269c22fa4df82a9c11c55c2ff5d0 as $v17f71d965fe9589ddbd11caf7182243e) {if($v17f71d965fe9589ddbd11caf7182243e instanceof umiFieldType) $this->data_types[] = $v17f71d965fe9589ddbd11caf7182243e->getId();}}public function isCompleted() {return $this->completed;}public function execute() {if(!is_null(getRequest('links'))) {$this->oldGetLinks = getRequest('links');unset($_REQUEST['links']);}$this->position = 0;$this->break = false;$v9a09b4dfda82e3e665e31092d1c3ec8d = new DOMDocument("1.0", "utf-8");$v9a09b4dfda82e3e665e31092d1c3ec8d->formatOutput = XML_FORMAT_OUTPUT;$v63a9f0ea7bb98050796b649e85481845 = $v9a09b4dfda82e3e665e31092d1c3ec8d->createElement("umidump");$v63a9f0ea7bb98050796b649e85481845->setAttribute('xmlns:xlink', 'http://www.w3.org/TR/xlink');$v0cc175b9c0f1b6a831c399e269772661 = $v9a09b4dfda82e3e665e31092d1c3ec8d->createAttribute("version");$v0cc175b9c0f1b6a831c399e269772661->appendChild($v9a09b4dfda82e3e665e31092d1c3ec8d->createTextNode(self::VERSION));$v63a9f0ea7bb98050796b649e85481845->appendChild($v0cc175b9c0f1b6a831c399e269772661);$v9a09b4dfda82e3e665e31092d1c3ec8d->appendChild($v63a9f0ea7bb98050796b649e85481845);$this->translator = new xmlTranslator($v9a09b4dfda82e3e665e31092d1c3ec8d);if ($this->showAllFields) {$ved2767f3d8b91be52c4cb22eb81a04b3 = xmlTranslator::$showHiddenFieldGroups;xmlTranslator::$showHiddenFieldGroups = true;$vcf90eeb77dd5c141a9e9b72790489e27 = xmlTranslator::$showUnsecureFields;xmlTranslator::$showUnsecureFields = true;}$v07d2e301ed1b9e6b89b58497f1810239 = umiObjectProperty::$IGNORE_CACHE;umiObjectProperty::$IGNORE_CACHE = true;$this->doc = $v9a09b4dfda82e3e665e31092d1c3ec8d;$this->root = $v63a9f0ea7bb98050796b649e85481845;if (file_exists(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name))) {$vf1f713c9e000f5d3f280adbd124df4f5 = unserialize(file_get_contents(CURRENT_WORKING_DIR . '/sys-temp/runtime-cache/' . md5($this->source_name)));$this->exported_files = $vf1f713c9e000f5d3f280adbd124df4f5['exported_files'];$this->exported_types = $vf1f713c9e000f5d3f280adbd124df4f5['exported_types'];$this->exported_langs = $vf1f713c9e000f5d3f280adbd124df4f5['exported_langs'];$this->exported_domains = $vf1f713c9e000f5d3f280adbd124df4f5['exported_domains'];$this->exported_templates = $vf1f713c9e000f5d3f280adbd124df4f5['exported_templates'];$this->exported_elements = $vf1f713c9e000f5d3f280adbd124df4f5['exported_elements'];$this->exported_objects = $vf1f713c9e000f5d3f280adbd124df4f5['exported_objects'];$this->exported_restrictions = $vf1f713c9e000f5d3f280adbd124df4f5['exported_restrictions'];$this->restricted_fields = $vf1f713c9e000f5d3f280adbd124df4f5['restricted_fields'];$this->restrictions = $vf1f713c9e000f5d3f280adbd124df4f5['restrictions'];$this->exported_registry_items = $vf1f713c9e000f5d3f280adbd124df4f5['exported_registry_items'];$this->exported_data_types = $vf1f713c9e000f5d3f280adbd124df4f5['exported_data_types'];$this->exported_dirs = $vf1f713c9e000f5d3f280adbd124df4f5['exported_dirs'];}$this->createGrid();if ($this->directories && !$this->break) $this->exportDirs();if ($this->files && !$this->break) $this->exportFiles();if ($this->langs && !$this->break) $this->exportLangs();if ($this->domains && !$this->break) $this->exportDomains();if ($this->templates && !$this->break) $this->exportTemplates();if ($this->data_types && !$this->break) $this->exportDataTypes();if ($this->types && !$this->break) $this->exportTypes();if ($this->objects && !$this->break) $this->exportObjects();if ($this->elements && !$this->break) $this->exportElements();if ($this->branches && !$this->break) $this->exportBranches();if ($this->restrictions && !$this->break) $this->exportRestrictions();if ($this->registry && !$this->break) $this->exportRegs();$v8277e0910d750195b448797616e091ad = $this->doc;$v6f8f57715090da2632453988d9a1501b = $this->meta_container;$this->completed = !$this->break;if (count($this->branches) && $this->completed) {$v92ec19ffde05e15769b1bb3ee05ad745 = array();foreach ($this->branches as $v09fd5b139469053e6cd6e28cf8725337) {if (isset($this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337]) && $this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337] != 'found') {$v09fd5b139469053e6cd6e28cf8725337 = $this->exported_elements[$v09fd5b139469053e6cd6e28cf8725337];}$v92ec19ffde05e15769b1bb3ee05ad745[] = $v09fd5b139469053e6cd6e28cf8725337;}$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('branches');$this->translateEntity(array('nodes:id' => $v92ec19ffde05e15769b1bb3ee05ad745), $v7b8b965ad4bca0e41ab51de7b31363a1);$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);}$this->saveState();if ($this->showAllFields) {xmlTranslator::$showHiddenFieldGroups = $ved2767f3d8b91be52c4cb22eb81a04b3;xmlTranslator::$showUnsecureFields = $vcf90eeb77dd5c141a9e9b72790489e27;}umiObjectProperty::$IGNORE_CACHE = $v07d2e301ed1b9e6b89b58497f1810239;if(!is_null($this->oldGetLinks)) $_REQUEST['links'] = $this->oldGetLinks;return $this->doc;}protected function createDateSection($vd7e6d55ba379a13d08c25d15faf2a23b, DOMElement $v5f0b6ebc4bea10285ba2b8a6ce78b863) {$v8277e0910d750195b448797616e091ad = $this->doc;$v5fc732311905cb27e82d67f4f6511f7f = new umiDate($vd7e6d55ba379a13d08c25d15faf2a23b);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('timestamp');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate("U")));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('rfc');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate("r")));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('utc');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createTextNode($v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate(DATE_ATOM)));$v5f0b6ebc4bea10285ba2b8a6ce78b863->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);return $v5f0b6ebc4bea10285ba2b8a6ce78b863;}protected function createGrid() {$v8277e0910d750195b448797616e091ad = $this->doc;$v6f8f57715090da2632453988d9a1501b = $v8277e0910d750195b448797616e091ad->createElement("meta");$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vad5f82e879a9c5d6b5b442eb37e50551 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain();$v7572559ca86e781ba8fe8073a0b725c6 = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang();$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('site-name');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($vb1444fb0c07653567ad325aa25d4e37a->getVal("//settings/site_name")));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('domain');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($vad5f82e879a9c5d6b5b442eb37e50551->getHost()));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('lang');$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($v7572559ca86e781ba8fe8073a0b725c6->getPrefix()));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('source-name');$v3a6d0284e743dc4a9b86f97d6dd1a3bf = strlen($this->source_name) ? $this->source_name : md5($vad5f82e879a9c5d6b5b442eb37e50551->getId() . $v7572559ca86e781ba8fe8073a0b725c6->getId());$v7b8b965ad4bca0e41ab51de7b31363a1->appendChild($v8277e0910d750195b448797616e091ad->createCDATASection($v3a6d0284e743dc4a9b86f97d6dd1a3bf));$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$v7b8b965ad4bca0e41ab51de7b31363a1 = $v8277e0910d750195b448797616e091ad->createElement('generate-time');$this->createDateSection(time(), $v7b8b965ad4bca0e41ab51de7b31363a1);$v6f8f57715090da2632453988d9a1501b->appendChild($v7b8b965ad4bca0e41ab51de7b31363a1);$this->root->appendChild($v6f8f57715090da2632453988d9a1501b);$this->meta_container = $v6f8f57715090da2632453988d9a1501b;$this->registry_container = $v8277e0910d750195b448797616e091ad->createElement('registry');$this->root->appendChild($this->registry_container);$this->dirs_container = $v8277e0910d750195b448797616e091ad->createElement('directories');$this->root->appendChild($this->dirs_container);$this->files_container = $v8277e0910d750195b448797616e091ad->createElement('files');$this->root->appendChild($this->files_container);$this->langs_container = $v8277e0910d750195b448797616e091ad->createElement('langs');$this->root->appendChild($this->langs_container);$this->domains_container = $v8277e0910d750195b448797616e091ad->createElement('domains');$this->root->appendChild($this->domains_container);$this->templates_container = $v8277e0910d750195b448797616e091ad->createElement('templates');$this->root->appendChild($this->templates_container);$this->data_types_container = $v8277e0910d750195b448797616e091ad->createElement('datatypes');$this->root->appendChild($this->data_types_container);$this->types_container = $v8277e0910d750195b448797616e091ad->createElement('types');$this->root->appendChild($this->types_container);$this->objects_container = $v8277e0910d750195b448797616e091ad->createElement('objects');$this->root->appendChild($this->objects_container);$this->pages_container = $v8277e0910d750195b448797616e091ad->createElement('pages');$this->root->appendChild($this->pages_container);$this->relations_container = $v8277e0910d750195b448797616e091ad->createElement('relations');$this->root->appendChild($this->relations_container);$this->options_container = $v8277e0910d750195b448797616e091ad->createElement('options');$this->root->appendChild($this->options_container);$this->restrictions_container = $v8277e0910d750195b448797616e091ad->createElement('restrictions');$this->root->appendChild($this->restrictions_container);$this->permissions_container = $v8277e0910d750195b448797616e091ad->createElement('permissions');$this->root->appendChild($this->permissions_container);$this->hierarchy_container = $v8277e0910d750195b448797616e091ad->createElement('hierarchy');$this->root->appendChild($this->hierarchy_container);}protected function translateEntity($vf5e638cc78dd325906c1298a0c21fb6b, $v5f0b6ebc4bea10285ba2b8a6ce78b863) {$result = $this->translator->chooseTranslator($v5f0b6ebc4bea10285ba2b8a6ce78b863, $vf5e638cc78dd325906c1298a0c21fb6b, true);}protected function exportFile(umiFile $v8c7dd922ad47494fc02c388e12c00eac) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v8c7dd922ad47494fc02c388e12c00eac->getFilePath();if (isset($this->exported_files[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v5b063e275d506f65ebf1b02d926f19a4 = $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('file');$this->files_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->translateEntity($v8c7dd922ad47494fc02c388e12c00eac, $v4a8a08f09d37b73795649038408b5f33);$v0800fc577294c34e0b28ad2839435945 = md5_file($vd6fe1d0be6347b8ef2427fa629c04485);$v4493ba1ac6e2a63455acda96db3da768 = $this->doc->createAttribute("hash");$v4a8a08f09d37b73795649038408b5f33->appendChild($v4493ba1ac6e2a63455acda96db3da768);$va14ef8ab1dc3a33642fcbdc20b856dbb = $this->doc->createTextNode("{$v0800fc577294c34e0b28ad2839435945}");$v4493ba1ac6e2a63455acda96db3da768->appendChild($va14ef8ab1dc3a33642fcbdc20b856dbb);$v5b063e275d506f65ebf1b02d926f19a4 = $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$vc29a0c0bef824ee1691bc91da9b60bb7 = $this->doc->createAttribute("name");$v4a8a08f09d37b73795649038408b5f33->appendChild($vc29a0c0bef824ee1691bc91da9b60bb7);$v7affb12a524a065ba5ff47dc80e5bd68 = $this->doc->createTextNode("{$v5b063e275d506f65ebf1b02d926f19a4}");$vc29a0c0bef824ee1691bc91da9b60bb7->appendChild($v7affb12a524a065ba5ff47dc80e5bd68);if ($this->destination) {$v47826cacc65c665212b821e6ff80b9b0 = $this->destination . $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(true);$vaedcc8bf00dbfd959b5898fe1e21c7ab = dirname($v47826cacc65c665212b821e6ff80b9b0);if (!file_exists($vaedcc8bf00dbfd959b5898fe1e21c7ab)) mkdir($vaedcc8bf00dbfd959b5898fe1e21c7ab, 0777, true);if (copy($vd6fe1d0be6347b8ef2427fa629c04485, $v47826cacc65c665212b821e6ff80b9b0)) {chmod($v47826cacc65c665212b821e6ff80b9b0, 0777);}else {$this->reportError("File \"{$vd6fe1d0be6347b8ef2427fa629c04485} \" cannot be copied to \"{$v47826cacc65c665212b821e6ff80b9b0}\"");}}else {$this->reportError('Files cannot be copied because destination folder isn\'t defined');}$this->exported_files[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportDir(umiDirectory $v5f8f22b8cdbaeee8cf857673a9b6ba20) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v5f8f22b8cdbaeee8cf857673a9b6ba20->getPath();$v651fd5d791e56187822de080423fe012 = ltrim($vd6fe1d0be6347b8ef2427fa629c04485, '.');if (isset($this->exported_dirs[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('directory', $v651fd5d791e56187822de080423fe012);$this->dirs_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->setAttribute('path', $vd6fe1d0be6347b8ef2427fa629c04485);$v4a8a08f09d37b73795649038408b5f33->setAttribute('name', $v5f8f22b8cdbaeee8cf857673a9b6ba20->getName());$this->exported_dirs[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportFiles() {foreach ($this->files as $v8c7dd922ad47494fc02c388e12c00eac) {$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}if ($this->destination) {$vf35596be31d40176826fce6b837a9ddc = new umiDirectory($this->destination);$v00c9a807e725e6d86bde261aa73866a8 = $vf35596be31d40176826fce6b837a9ddc->getFSObjects(2);foreach ($v00c9a807e725e6d86bde261aa73866a8 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v736007832d2167baaae763fd3a3f3cf1) {chmod($v736007832d2167baaae763fd3a3f3cf1, 0777);}}}protected function exportDirs() {foreach ($this->directories as $v5f8f22b8cdbaeee8cf857673a9b6ba20) {$this->exportDir($v5f8f22b8cdbaeee8cf857673a9b6ba20);}}protected function exportLang($vf585b7f018bb4ced15a03683a733e50b) {if (isset($this->exported_langs[$vf585b7f018bb4ced15a03683a733e50b])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v7572559ca86e781ba8fe8073a0b725c6 = langsCollection::getInstance()->getLang($vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('lang');$this->translateEntity($v7572559ca86e781ba8fe8073a0b725c6, $v4a8a08f09d37b73795649038408b5f33);$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);if ($v392cdf2310e931972f2459edc1ea2ff2 === false) {$this->relations->setLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b, $vf585b7f018bb4ced15a03683a733e50b);$v392cdf2310e931972f2459edc1ea2ff2 = $vf585b7f018bb4ced15a03683a733e50b;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v392cdf2310e931972f2459edc1ea2ff2);}$this->langs_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_langs[$vf585b7f018bb4ced15a03683a733e50b] = $v392cdf2310e931972f2459edc1ea2ff2;$this->position++;return true;}protected function exportLangs() {foreach ($this->langs as $v7572559ca86e781ba8fe8073a0b725c6) {$this->exportLang($v7572559ca86e781ba8fe8073a0b725c6);}}protected function exportDomain(domain $vad5f82e879a9c5d6b5b442eb37e50551) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $vad5f82e879a9c5d6b5b442eb37e50551->getId();if (isset($this->exported_domains[$v72ee76c5c29383b7c9f9225c1fa4d10b])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('domain');$this->translateEntity($vad5f82e879a9c5d6b5b442eb37e50551, $v4a8a08f09d37b73795649038408b5f33);$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);if ($v0bb5aff4a4154504d1117c453c35edd8 === false) {$this->relations->setDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v0bb5aff4a4154504d1117c453c35edd8 = $v72ee76c5c29383b7c9f9225c1fa4d10b;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v0bb5aff4a4154504d1117c453c35edd8);}$vf585b7f018bb4ced15a03683a733e50b = $vad5f82e879a9c5d6b5b442eb37e50551->getDefaultLangId();if ($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v4b9c7061b34a64924383494f4cd28b13 = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrowsList();foreach ($v4b9c7061b34a64924383494f4cd28b13 as $v95be0a2e6132b4fa2294808f7dbcc52a) {$v6f8f57715090da2632453988d9a1501b = $this->doc->createElement('domain-mirror');$v4a8a08f09d37b73795649038408b5f33->appendChild($v6f8f57715090da2632453988d9a1501b);$this->translateEntity($v95be0a2e6132b4fa2294808f7dbcc52a, $v6f8f57715090da2632453988d9a1501b);$v1834e28d86200a836697541c12fa09bd = $v95be0a2e6132b4fa2294808f7dbcc52a->getId();$ve788cc9c8ff1d105698156a7628ff6ef = $this->relations->getOldDomainMirrorIdRelation($this->source_id, $v1834e28d86200a836697541c12fa09bd);if ($ve788cc9c8ff1d105698156a7628ff6ef === false) {$this->relations->setDomainMirrorIdRelation($this->source_id, $v1834e28d86200a836697541c12fa09bd, $v1834e28d86200a836697541c12fa09bd);$ve788cc9c8ff1d105698156a7628ff6ef = $v1834e28d86200a836697541c12fa09bd;}else {$v6f8f57715090da2632453988d9a1501b->setAttribute('id', $ve788cc9c8ff1d105698156a7628ff6ef);}}$this->domains_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_domains[$v72ee76c5c29383b7c9f9225c1fa4d10b] = $v0bb5aff4a4154504d1117c453c35edd8;$this->position++;return true;}protected function exportDomains() {foreach ($this->domains as $vad5f82e879a9c5d6b5b442eb37e50551) {$this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551);}}protected function exportTemplate(template $v66f6181bcb4cff4cd38fbc804a036db6) {$v3200a31fc05da4e9d5a0465c36822e2f = $v66f6181bcb4cff4cd38fbc804a036db6->getId();if (isset($this->exported_templates[$v3200a31fc05da4e9d5a0465c36822e2f])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('template');$this->translateEntity($v66f6181bcb4cff4cd38fbc804a036db6, $v4a8a08f09d37b73795649038408b5f33);$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $v3200a31fc05da4e9d5a0465c36822e2f);if ($vd01a3cac3018d018ad8bef5c05012c94 === false) {$this->relations->setTemplateIdRelation($this->source_id, $v3200a31fc05da4e9d5a0465c36822e2f, $v3200a31fc05da4e9d5a0465c36822e2f);$vd01a3cac3018d018ad8bef5c05012c94 = $v3200a31fc05da4e9d5a0465c36822e2f;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $vd01a3cac3018d018ad8bef5c05012c94);}$vf585b7f018bb4ced15a03683a733e50b = $v66f6181bcb4cff4cd38fbc804a036db6->getLangId();if($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v72ee76c5c29383b7c9f9225c1fa4d10b = $v66f6181bcb4cff4cd38fbc804a036db6->getDomainId();$vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v4a8a08f09d37b73795649038408b5f33->setAttribute('domain-id', $v0bb5aff4a4154504d1117c453c35edd8);$this->templates_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_templates[$v3200a31fc05da4e9d5a0465c36822e2f] = $vd01a3cac3018d018ad8bef5c05012c94;$this->position++;return true;}protected function exportTemplates() {foreach ($this->templates as $v66f6181bcb4cff4cd38fbc804a036db6) {$this->exportTemplate($v66f6181bcb4cff4cd38fbc804a036db6);}}protected function exportDataType($v94757cae63fd3e398c0811a976dd6bbe) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiFieldTypesCollection::getInstance()->getFieldType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiFieldType) return false;if (isset($this->exported_data_types[$v94757cae63fd3e398c0811a976dd6bbe])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('datatype');$this->data_types_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->translateEntity($v599dcce2998a6b40b1e38e8c6006cb0a, $v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->removeAttribute('id');$this->exported_data_types[$v94757cae63fd3e398c0811a976dd6bbe] = $v94757cae63fd3e398c0811a976dd6bbe;}protected function exportType($v94757cae63fd3e398c0811a976dd6bbe) {$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) return false;if (isset($this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe] = 'found';$v2e3c048401582f4247d7ccac43657d2d = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {if ($this->exportType($v2e3c048401582f4247d7ccac43657d2d)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('type');$this->translateEntity($v599dcce2998a6b40b1e38e8c6006cb0a, $v4a8a08f09d37b73795649038408b5f33);$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);if (!$va240be392fd0549ece5558553983d79b) {$va240be392fd0549ece5558553983d79b = ($v94757cae63fd3e398c0811a976dd6bbe == self::$ROOT_PAGE_TYPE_ID) ? '{root-pages-type}' : $v94757cae63fd3e398c0811a976dd6bbe;$this->relations->setTypeIdRelation($this->source_id, $va240be392fd0549ece5558553983d79b, $v94757cae63fd3e398c0811a976dd6bbe);}$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $va240be392fd0549ece5558553983d79b);$v2e3c048401582f4247d7ccac43657d2d = $v599dcce2998a6b40b1e38e8c6006cb0a->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {$vd3fbb9ff0b93cc92c5414344402a74bb = $this->relations->getOldTypeIdRelation($this->source_id, $v2e3c048401582f4247d7ccac43657d2d);if ($vd3fbb9ff0b93cc92c5414344402a74bb === false) {$vd3fbb9ff0b93cc92c5414344402a74bb = ($v2e3c048401582f4247d7ccac43657d2d == self::$ROOT_PAGE_TYPE_ID) ? '{root-pages-type}' : $v2e3c048401582f4247d7ccac43657d2d;$this->relations->setTypeIdRelation($this->source_id, $vd3fbb9ff0b93cc92c5414344402a74bb, $v2e3c048401582f4247d7ccac43657d2d);}$v4a8a08f09d37b73795649038408b5f33->setAttribute('parent-id', $vd3fbb9ff0b93cc92c5414344402a74bb);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("base", $v4a8a08f09d37b73795649038408b5f33)->length) {$v593616de15330c0fb2d55e55410bf994 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("base", $v4a8a08f09d37b73795649038408b5f33)->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45) {$v47db2588331bbe530c80dd001fc60aed = $vdb0f6f37ebeb6ea09489124345af2a45->getAttribute('id');$v7617417dc7eb3bbc463bf3c66d341d7b = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v47db2588331bbe530c80dd001fc60aed, true);if ($v7617417dc7eb3bbc463bf3c66d341d7b->getIsActive()) {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('active', 'active');}else {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('active', '0');}if(!$v7617417dc7eb3bbc463bf3c66d341d7b->getIsVisible()) {$vdb0f6f37ebeb6ea09489124345af2a45->setAttribute('visible', '0');}$vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}}$v5df80bc8ce306a564d91fa6a4da3d95b = array();$v8797e64b0b663bbad43134e3003a4ef4 = umiFieldsCollection::getInstance();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("fieldgroups/group/field", $v4a8a08f09d37b73795649038408b5f33);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('name');$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf === false) {$this->relations->setFieldIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v73f329f154a663bfda020aadcdd0b775, $v3aabf39f2d943fa886d86dcbbee4d910);$v528ca8fdf35a8b13b093b5786a22c0bf = $v73f329f154a663bfda020aadcdd0b775;}else {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}if($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('restriction')->length) {$v23604f9ddf406aa61ce8b1eaf9f6d39a = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('restriction')->item(0);$v228c63e369a5906eb7f0500a13729edc = $v23604f9ddf406aa61ce8b1eaf9f6d39a->getAttribute('id');$this->restrictions[] = $v228c63e369a5906eb7f0500a13729edc;$this->restricted_fields[] = array(      'restriction-id' => $v228c63e369a5906eb7f0500a13729edc,      'field-name' => $v528ca8fdf35a8b13b093b5786a22c0bf,      'type-id' => $va240be392fd0549ece5558553983d79b     );$v23604f9ddf406aa61ce8b1eaf9f6d39a->removeAttribute('field-type-id');}$v051369818a8073bba5feeb0e957eb308 = $v06e3d36fa30cea095545139854ad1fb9->hasAttribute('guide-id') ? $v06e3d36fa30cea095545139854ad1fb9->getAttribute('guide-id') : false;if ($v051369818a8073bba5feeb0e957eb308 && (!$this->ignoreRelations || in_array('guides', $this->saveRelations))) {if ($this->exportType($v051369818a8073bba5feeb0e957eb308)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->id($v051369818a8073bba5feeb0e957eb308);$v8be74552df93e31bbdd6b36ed74bdb6a->option('return')->value('id');foreach ($v8be74552df93e31bbdd6b36ed74bdb6a->result as $v9b207167e5381c47682c6b4f58a623fb) {if ($this->exportObject($v9b207167e5381c47682c6b4f58a623fb['id'])) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}}$vd4276536125c741369298bfbf2817a8a = $this->relations->getOldTypeIdRelation($this->source_id, $v051369818a8073bba5feeb0e957eb308);$v06e3d36fa30cea095545139854ad1fb9->setAttribute('guide-id', $vd4276536125c741369298bfbf2817a8a);$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('guide');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $vd4276536125c741369298bfbf2817a8a);$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('type')->length){$v519504d7d4beb745dac24ccfb6c1d7c9 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('type')->item(0);$v519504d7d4beb745dac24ccfb6c1d7c9->removeAttribute('id');}$vce6ba6b4afd61be6d0f21f1e2a995213 = $v8797e64b0b663bbad43134e3003a4ef4->getField($v3aabf39f2d943fa886d86dcbbee4d910);if ($vce6ba6b4afd61be6d0f21f1e2a995213->getIsSystem()) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('system', 'system');}$v06e3d36fa30cea095545139854ad1fb9->removeAttribute('field-type-id');}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}$this->types_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_types[$v94757cae63fd3e398c0811a976dd6bbe] = $va240be392fd0549ece5558553983d79b;$this->position++;return true;}protected function exportRestriction($v228c63e369a5906eb7f0500a13729edc) {if (isset($this->exported_restrictions[$v228c63e369a5906eb7f0500a13729edc])) return false;$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v228c63e369a5906eb7f0500a13729edc);if (!$v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) return false;$vf3ecaaa779127f3ec136cca581bfaf46 = $v3dadfaeb46ec74762b37de11fea7605c->getClassName();$vf52176cf6508ff07e507a49978c0fc2f = $v3dadfaeb46ec74762b37de11fea7605c->getTitle();$v94757cae63fd3e398c0811a976dd6bbe = $v3dadfaeb46ec74762b37de11fea7605c->getFieldTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiFieldTypesCollection::getInstance()->getFieldType($v94757cae63fd3e398c0811a976dd6bbe);$v17f71d965fe9589ddbd11caf7182243e = $v599dcce2998a6b40b1e38e8c6006cb0a->getDataType();$v96a76ec43956dac431b643cbd544dd08 = $v599dcce2998a6b40b1e38e8c6006cb0a->getIsMultiple();$v6896b87ef0ed896869194f78f21380e7 = $this->relations->getOldRestrictionIdRelation($this->source_id, $v228c63e369a5906eb7f0500a13729edc);if (!$v6896b87ef0ed896869194f78f21380e7) {$this->relations->setRestrictionIdRelation($this->source_id, $v228c63e369a5906eb7f0500a13729edc, $v228c63e369a5906eb7f0500a13729edc);$v6896b87ef0ed896869194f78f21380e7 = $v228c63e369a5906eb7f0500a13729edc;}$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('restriction');$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v6896b87ef0ed896869194f78f21380e7);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('prefix', $vf3ecaaa779127f3ec136cca581bfaf46);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('title', $vf52176cf6508ff07e507a49978c0fc2f);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('field-type', $v17f71d965fe9589ddbd11caf7182243e);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('is-multiple', $v96a76ec43956dac431b643cbd544dd08);foreach ($this->restricted_fields as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if ($v2063c1608d6e0baf80249c42e2be5804['restriction-id'] == $v228c63e369a5906eb7f0500a13729edc) {$v8fa14cdd754f91cc6554c9e71929cce7 = $this->doc->createElement('field');$v8fa14cdd754f91cc6554c9e71929cce7->setAttribute('field-name', $v2063c1608d6e0baf80249c42e2be5804['field-name']);$v8fa14cdd754f91cc6554c9e71929cce7->setAttribute('type-id', $v2063c1608d6e0baf80249c42e2be5804['type-id']);$vd95679752134a2d9eb61dbd7b91c4bcc->appendChild($v8fa14cdd754f91cc6554c9e71929cce7);}}$this->restrictions_container->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);$this->exported_restrictions[$v228c63e369a5906eb7f0500a13729edc] = $v6896b87ef0ed896869194f78f21380e7;$this->position++;return true;}protected function exportReg($vd6fe1d0be6347b8ef2427fa629c04485) {if (isset($this->exported_registry_items[$vd6fe1d0be6347b8ef2427fa629c04485])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");$v3c6e0b8a9c15224a8228b9a98ca1531d = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $vb1444fb0c07653567ad325aa25d4e37a->getVal($vd6fe1d0be6347b8ef2427fa629c04485);if (!$v3c6e0b8a9c15224a8228b9a98ca1531d) return false;if(strrpos($vd6fe1d0be6347b8ef2427fa629c04485, '/') != false) {$v6b3e5c01522ed94ff36d244b4401bd17 = substr_replace($vd6fe1d0be6347b8ef2427fa629c04485, '', strrpos($vd6fe1d0be6347b8ef2427fa629c04485, '/'));if ($this->exportReg($v6b3e5c01522ed94ff36d244b4401bd17)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}}$v865c0c0b4ab0e063e5caa3387c1a8741 = $this->doc->createElement('key');$this->registry_container->appendChild($v865c0c0b4ab0e063e5caa3387c1a8741);$v865c0c0b4ab0e063e5caa3387c1a8741->setAttribute('path', $vd6fe1d0be6347b8ef2427fa629c04485);$v865c0c0b4ab0e063e5caa3387c1a8741->setAttribute('val', $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$this->exported_registry_items[$vd6fe1d0be6347b8ef2427fa629c04485] = $vd6fe1d0be6347b8ef2427fa629c04485;$this->position++;return true;}protected function exportRestrictions() {if (!$this->ignoreRelations || in_array('restrictions', $this->saveRelations)){foreach ($this->restrictions as $v3dadfaeb46ec74762b37de11fea7605c) {$this->exportRestriction($v3dadfaeb46ec74762b37de11fea7605c);}}}protected function exportTypes() {foreach ($this->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {$this->exportType($v599dcce2998a6b40b1e38e8c6006cb0a);}}protected function exportBranches() {foreach ($this->branches as $v9603a224b40d7b67210b78f2e390d00f) {if ($this->break) break;$this->exportBranch($v9603a224b40d7b67210b78f2e390d00f);}}protected function exportBranch($v7057e8409c7c531a1a6e9ac3df4ed549) {$this->exportElement($v7057e8409c7c531a1a6e9ac3df4ed549);$vadce578d04ed03c31f6ac59451fcf8e4 = umiHierarchy::getInstance()->getChilds($v7057e8409c7c531a1a6e9ac3df4ed549, true, true, 1);foreach ($vadce578d04ed03c31f6ac59451fcf8e4 as $vf36263a38d7de5cdaa953c1e2b2f79b5 => $vfa816edb83e95bf0c8da580bdfd491ef) {if ($this->break) return false;$this->exportElement($vf36263a38d7de5cdaa953c1e2b2f79b5);$this->exportBranch($vf36263a38d7de5cdaa953c1e2b2f79b5);}}protected function exportElement($v7057e8409c7c531a1a6e9ac3df4ed549) {umiHierarchy::getInstance()->clearCache();if (isset($this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = 'found';$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectTypeId();if ($this->exportType($v94757cae63fd3e398c0811a976dd6bbe)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('page');$this->translateEntity($v8e2dcfd7e7e24b1ca76c1193f645902b, $v4a8a08f09d37b73795649038408b5f33);$v4a8a08f09d37b73795649038408b5f33->removeAttribute('update-time');$vf585b7f018bb4ced15a03683a733e50b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId();if (!$this->ignoreRelations || in_array('langs', $this->saveRelations)) {if ($this->exportLang($vf585b7f018bb4ced15a03683a733e50b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);}else {$v392cdf2310e931972f2459edc1ea2ff2 = $this->relations->getOldLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);if ($v392cdf2310e931972f2459edc1ea2ff2 === false) {$this->relations->setLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b, $vf585b7f018bb4ced15a03683a733e50b);$v392cdf2310e931972f2459edc1ea2ff2 = $vf585b7f018bb4ced15a03683a733e50b;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('lang-id', $v392cdf2310e931972f2459edc1ea2ff2);$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getDomainId();if (!$this->ignoreRelations || in_array('domains', $this->saveRelations)) {$vad5f82e879a9c5d6b5b442eb37e50551 = domainsCollection::getInstance()->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($this->exportDomain($vad5f82e879a9c5d6b5b442eb37e50551)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);}else {$v0bb5aff4a4154504d1117c453c35edd8 = $this->relations->getOldDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);if ($v0bb5aff4a4154504d1117c453c35edd8 === false) {$this->relations->setDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b, $v72ee76c5c29383b7c9f9225c1fa4d10b);$v0bb5aff4a4154504d1117c453c35edd8 = $v72ee76c5c29383b7c9f9225c1fa4d10b;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('domain-id', $v0bb5aff4a4154504d1117c453c35edd8);$vd02e12eb6d6c3f6ebd763197df01e211   = $v8e2dcfd7e7e24b1ca76c1193f645902b->getTplId();if (!$this->ignoreRelations || in_array('templates', $this->saveRelations)) {$v66f6181bcb4cff4cd38fbc804a036db6 = templatesCollection::getInstance()->getTemplate($vd02e12eb6d6c3f6ebd763197df01e211);if ($this->exportTemplate($v66f6181bcb4cff4cd38fbc804a036db6)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211);}else {$vd01a3cac3018d018ad8bef5c05012c94 = $this->relations->getOldTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211);if ($vd01a3cac3018d018ad8bef5c05012c94 === false) {$this->relations->setTemplateIdRelation($this->source_id, $vd02e12eb6d6c3f6ebd763197df01e211, $vd02e12eb6d6c3f6ebd763197df01e211);$vd01a3cac3018d018ad8bef5c05012c94 = $vd02e12eb6d6c3f6ebd763197df01e211;}}$vf9bdb7221804d6d17b654ec67c5a0735  = templatesCollection::getInstance()->getTemplate($vd02e12eb6d6c3f6ebd763197df01e211)->getFilename();$v557c9fc3c1f769c263ae2d3113ff1501 = $this->doc->createElement('template');$v557c9fc3c1f769c263ae2d3113ff1501->setAttribute("id", $vd01a3cac3018d018ad8bef5c05012c94);$v557c9fc3c1f769c263ae2d3113ff1501->appendChild($this->doc->createTextNode($vf9bdb7221804d6d17b654ec67c5a0735));$v4a8a08f09d37b73795649038408b5f33->appendChild($v557c9fc3c1f769c263ae2d3113ff1501);$v13fba93b98196f2395dec474c9ba27e5 = $this->relations->getOldIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549);if ($v13fba93b98196f2395dec474c9ba27e5 === false) {$this->relations->setIdRelation($this->source_id, $v7057e8409c7c531a1a6e9ac3df4ed549, $v7057e8409c7c531a1a6e9ac3df4ed549);$v13fba93b98196f2395dec474c9ba27e5 = $v7057e8409c7c531a1a6e9ac3df4ed549;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $v13fba93b98196f2395dec474c9ba27e5);}$v6be379826b20cc58475f636e33f4606b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();if ($v6be379826b20cc58475f636e33f4606b) {$v65dce76bfdfbc3dfd9962e8d154dab64 = $this->relations->getOldIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b);if ($v65dce76bfdfbc3dfd9962e8d154dab64 === false) {$this->relations->setIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b, $v6be379826b20cc58475f636e33f4606b);$v65dce76bfdfbc3dfd9962e8d154dab64 = $v6be379826b20cc58475f636e33f4606b;}$v4a8a08f09d37b73795649038408b5f33->setAttribute('parentId', $v65dce76bfdfbc3dfd9962e8d154dab64);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("basetype", $v4a8a08f09d37b73795649038408b5f33)->length) {$v593616de15330c0fb2d55e55410bf994 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("basetype", $v4a8a08f09d37b73795649038408b5f33)->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);$v4a8a08f09d37b73795649038408b5f33->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);$vaf31437ce61345f416579830a98c91e5 = $v4a8a08f09d37b73795649038408b5f33->getAttribute('object-id');if (!$this->ignoreRelations || in_array('objects', $this->saveRelations)) {if ($this->exportObject($vaf31437ce61345f416579830a98c91e5)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);}else {$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);if ($vdad7dfa79a52fb5c76dff4c6bc0ddfe4 === false) {$this->relations->setObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5, $vaf31437ce61345f416579830a98c91e5);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $vaf31437ce61345f416579830a98c91e5;}}$v4a8a08f09d37b73795649038408b5f33->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45)     if($vdb0f6f37ebeb6ea09489124345af2a45->hasAttribute('id')) $vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group/property", $v4a8a08f09d37b73795649038408b5f33);$v5df80bc8ce306a564d91fa6a4da3d95b = array();$vc639bc918ec583ce6a914b6bbb29095d = array();foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}$v519504d7d4beb745dac24ccfb6c1d7c9 = $v06e3d36fa30cea095545139854ad1fb9->getAttribute('type');if (!$this->ignoreRelations || in_array('fields_relations', $this->saveRelations)) {if ($v519504d7d4beb745dac24ccfb6c1d7c9 == 'relation') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5 );$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v519504d7d4beb745dac24ccfb6c1d7c9 == 'symlink') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if($v519504d7d4beb745dac24ccfb6c1d7c9 == 'optioned') {$ve1671797c52e15f763380b45e841ec32  = $this->doc->createElement('entity');$ve1671797c52e15f763380b45e841ec32->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);$ve1671797c52e15f763380b45e841ec32->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32)) return true;$vc639bc918ec583ce6a914b6bbb29095d[] = $ve1671797c52e15f763380b45e841ec32;}}if (!$this->ignoreRelations || in_array('files', $this->saveRelations)) {if($v519504d7d4beb745dac24ccfb6c1d7c9 == 'file' || $v519504d7d4beb745dac24ccfb6c1d7c9 == 'swf_file' || $v519504d7d4beb745dac24ccfb6c1d7c9 == 'img_file') {$v97fd815a3803a0588876bdd862014fed = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('value')->item(0)->nodeValue;if (file_exists(CURRENT_WORKING_DIR . $v97fd815a3803a0588876bdd862014fed)) {$v8c7dd922ad47494fc02c388e12c00eac = new umiFile(CURRENT_WORKING_DIR . $v97fd815a3803a0588876bdd862014fed);$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}elseif (file_exists('./' . $v97fd815a3803a0588876bdd862014fed)) {$v8c7dd922ad47494fc02c388e12c00eac = new umiFile('./' . $v97fd815a3803a0588876bdd862014fed);$this->exportFile($v8c7dd922ad47494fc02c388e12c00eac);}}}}$v9f5a2d64925838158f3ef0a206b58c00 = array();if (!$this->ignoreRelations || in_array('permissions', $this->saveRelations)) {$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance()->getRecordedPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);if(is_array($v41275a535677f79ff347e01bc530c176)) {$v83878c91171338902e0fe0fb97a8c47a = $this->doc->createElement('permission');$v83878c91171338902e0fe0fb97a8c47a->setAttribute('page-id', $v13fba93b98196f2395dec474c9ba27e5);foreach ($v41275a535677f79ff347e01bc530c176 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('owner');if ($this->exportObject($v3c6e0b8a9c15224a8228b9a98ca1531d)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v27742af9ed1c41ae081ab4e34d376042 = $this->relations->getOldObjectIdRelation($this->source_id, $v3c6e0b8a9c15224a8228b9a98ca1531d);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v27742af9ed1c41ae081ab4e34d376042);$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('level', $v2063c1608d6e0baf80249c42e2be5804);$v83878c91171338902e0fe0fb97a8c47a->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}$v9f5a2d64925838158f3ef0a206b58c00[] = $v83878c91171338902e0fe0fb97a8c47a;}}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}foreach ($vc639bc918ec583ce6a914b6bbb29095d as $ve1671797c52e15f763380b45e841ec32) {$this->options_container->appendChild($ve1671797c52e15f763380b45e841ec32);}foreach ($v9f5a2d64925838158f3ef0a206b58c00 as $v83878c91171338902e0fe0fb97a8c47a) {$this->permissions_container->appendChild($v83878c91171338902e0fe0fb97a8c47a);}if (!$this->ignoreRelations || in_array('hierarchy', $this->saveRelations)) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getOrd();$v2510c39011c5be704182423e3a695e91 = $this->doc->createElement('relation');$v2510c39011c5be704182423e3a695e91->setAttribute('id', $v13fba93b98196f2395dec474c9ba27e5);$v2510c39011c5be704182423e3a695e91->setAttribute('ord', $v8bef1cc20ada3bef55fdf132cb2a1cb9);if($v6be379826b20cc58475f636e33f4606b) {$v2510c39011c5be704182423e3a695e91->setAttribute('parent-id', $v65dce76bfdfbc3dfd9962e8d154dab64);}else {$v2510c39011c5be704182423e3a695e91->setAttribute('parent-id', 0);}$this->hierarchy_container->appendChild($v2510c39011c5be704182423e3a695e91);}$this->pages_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_elements[$v7057e8409c7c531a1a6e9ac3df4ed549] = $v13fba93b98196f2395dec474c9ba27e5;$this->position++;return true;}protected function exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9) {$vb3b32a2d422265cd25c3323ed0157f81 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('page');foreach ($vb3b32a2d422265cd25c3323ed0157f81 as $v71860c77c6745379b0d44304d66b6a13) {if ($this->exportElement($v71860c77c6745379b0d44304d66b6a13->getAttribute('id'))){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getOldIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('id'));$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('page');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $v1a63c8004d716c8b91f5b7af780555b9);$v71860c77c6745379b0d44304d66b6a13->setAttribute('id', $v1a63c8004d716c8b91f5b7af780555b9);if ($this->exportType($v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'))){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'));$v71860c77c6745379b0d44304d66b6a13->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);$v6be379826b20cc58475f636e33f4606b = $v71860c77c6745379b0d44304d66b6a13->getAttribute('parentId');if ($this->exportElement($v6be379826b20cc58475f636e33f4606b)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v65dce76bfdfbc3dfd9962e8d154dab64 = $this->relations->getOldIdRelation($this->source_id, $v6be379826b20cc58475f636e33f4606b);$v71860c77c6745379b0d44304d66b6a13->setAttribute('parentId', $v65dce76bfdfbc3dfd9962e8d154dab64);$vaf31437ce61345f416579830a98c91e5 = $v71860c77c6745379b0d44304d66b6a13->getAttribute('object-id');if ($this->exportObject($vaf31437ce61345f416579830a98c91e5)){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);$v71860c77c6745379b0d44304d66b6a13->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v71860c77c6745379b0d44304d66b6a13->removeAttribute('xlink:href');$v71860c77c6745379b0d44304d66b6a13->removeAttribute('update-time');if($v71860c77c6745379b0d44304d66b6a13->getElementsByTagName('basetype')->length){$v593616de15330c0fb2d55e55410bf994 = $v71860c77c6745379b0d44304d66b6a13->getElementsByTagName('basetype')->item(0);$v593616de15330c0fb2d55e55410bf994->removeAttribute('id');}$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);}$v691d502cfd0e0626cd3b058e5682ad1c = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('item');foreach ($v691d502cfd0e0626cd3b058e5682ad1c as $v447b7147e84be512208dcc0995d67ebc) {$v82bfda7962fd12f51163ae45886c4c62 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('id');if ($this->exportObject($v82bfda7962fd12f51163ae45886c4c62)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v4fa996b497da363e7b006f146bc31108 = $this->relations->getOldObjectIdRelation($this->source_id, $v82bfda7962fd12f51163ae45886c4c62);$v447b7147e84be512208dcc0995d67ebc->setAttribute('id', $v4fa996b497da363e7b006f146bc31108);$v7f6bf686f231a8b117f0fa7737fcd363 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('type-id');if ($this->exportType($v7f6bf686f231a8b117f0fa7737fcd363)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v379ac7b9bf2e946893adc737ef1fb48a = $this->relations->getOldTypeIdRelation($this->source_id, $v7f6bf686f231a8b117f0fa7737fcd363);$v447b7147e84be512208dcc0995d67ebc->setAttribute('type-id', $v379ac7b9bf2e946893adc737ef1fb48a);if ($v447b7147e84be512208dcc0995d67ebc->hasAttribute('ownerId')) {$v19e1960ba1b0c19de1d0581ddfaf4e83 = $v447b7147e84be512208dcc0995d67ebc->getAttribute('ownerId');if ($this->exportObject($v19e1960ba1b0c19de1d0581ddfaf4e83)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vdf509c0952bdcfb6fdc42144ea11b049 = $this->relations->getOldObjectIdRelation($this->source_id, $v19e1960ba1b0c19de1d0581ddfaf4e83);$v447b7147e84be512208dcc0995d67ebc->setAttribute('ownerId', $vdf509c0952bdcfb6fdc42144ea11b049);}$v447b7147e84be512208dcc0995d67ebc->removeAttribute('xlink:href');$vb2f5ff47436671b6e533d8dc3614845d = $this->doc->createElement('object');$vb2f5ff47436671b6e533d8dc3614845d->setAttribute('id', $v4fa996b497da363e7b006f146bc31108);$v4b43b0aee35624cd95b910189b3dc231->appendChild($vb2f5ff47436671b6e533d8dc3614845d);}return true;}protected function exportObject($vaf31437ce61345f416579830a98c91e5) {if (isset($this->exported_objects[$vaf31437ce61345f416579830a98c91e5])) return false;if ($this->limit) {if ($this->position >= $this->limit) {$this->break = true;return false;}}$this->exported_objects[$vaf31437ce61345f416579830a98c91e5] = 'found';$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) return false;$v94757cae63fd3e398c0811a976dd6bbe = $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();if ($this->exportType($v94757cae63fd3e398c0811a976dd6bbe)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v4a8a08f09d37b73795649038408b5f33 = $this->doc->createElement('object');$this->translateEntity($va8cfde6331bd59eb2ac96f8911c4b666, $v4a8a08f09d37b73795649038408b5f33);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $this->relations->getOldObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5);if ($vdad7dfa79a52fb5c76dff4c6bc0ddfe4 === false) {$this->relations->setObjectIdRelation($this->source_id, $vaf31437ce61345f416579830a98c91e5, $vaf31437ce61345f416579830a98c91e5);$vdad7dfa79a52fb5c76dff4c6bc0ddfe4 = $vaf31437ce61345f416579830a98c91e5;}else {$v4a8a08f09d37b73795649038408b5f33->setAttribute('id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);}$v3643b86326b2ffcc0a085b4dd3a4309b = new DOMXPath($this->doc);$va240be392fd0549ece5558553983d79b = $this->relations->getOldTypeIdRelation($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe);$v4a8a08f09d37b73795649038408b5f33->setAttribute('type-id', $va240be392fd0549ece5558553983d79b);if($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33)->length) {foreach($v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group", $v4a8a08f09d37b73795649038408b5f33) as $vdb0f6f37ebeb6ea09489124345af2a45)     if($vdb0f6f37ebeb6ea09489124345af2a45->hasAttribute('id')) $vdb0f6f37ebeb6ea09489124345af2a45->removeAttribute('id');}$v5df80bc8ce306a564d91fa6a4da3d95b = array();$vc639bc918ec583ce6a914b6bbb29095d = array();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v3643b86326b2ffcc0a085b4dd3a4309b->evaluate("properties/group/property", $v4a8a08f09d37b73795649038408b5f33);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v06e3d36fa30cea095545139854ad1fb9) {$v3aabf39f2d943fa886d86dcbbee4d910 = intval($v06e3d36fa30cea095545139854ad1fb9->getAttribute('id'));$v528ca8fdf35a8b13b093b5786a22c0bf = $this->relations->getOldFieldName($this->source_id, $v94757cae63fd3e398c0811a976dd6bbe, $v3aabf39f2d943fa886d86dcbbee4d910);if ($v528ca8fdf35a8b13b093b5786a22c0bf) {$v06e3d36fa30cea095545139854ad1fb9->setAttribute('name', $v528ca8fdf35a8b13b093b5786a22c0bf);}if(!$this->ignoreRelations || in_array('fields_relations', $this->saveRelations)) {if ($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'relation') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if ($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'symlink') {$v4b43b0aee35624cd95b910189b3dc231 = $this->doc->createElement('relation');$v4b43b0aee35624cd95b910189b3dc231->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$v4b43b0aee35624cd95b910189b3dc231->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportRelation($v4b43b0aee35624cd95b910189b3dc231, $v06e3d36fa30cea095545139854ad1fb9)) return true;$v5df80bc8ce306a564d91fa6a4da3d95b[] = $v4b43b0aee35624cd95b910189b3dc231;}if($v06e3d36fa30cea095545139854ad1fb9->getAttribute('type') == 'optioned') {$ve1671797c52e15f763380b45e841ec32 = $this->doc->createElement('entity');$ve1671797c52e15f763380b45e841ec32->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);$ve1671797c52e15f763380b45e841ec32->setAttribute('field-name', $v528ca8fdf35a8b13b093b5786a22c0bf);if (!$this->exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32)) return true;$vc639bc918ec583ce6a914b6bbb29095d[] = $ve1671797c52e15f763380b45e841ec32;}}}$v9f5a2d64925838158f3ef0a206b58c00 = array();if(!$this->ignoreRelations || in_array('permissions', $this->saveRelations)) {$v83878c91171338902e0fe0fb97a8c47a = $this->doc->createElement('permission');$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `module`, `method`, `allow` FROM cms_permissions WHERE owner_id = '{$vaf31437ce61345f416579830a98c91e5}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce, $vb394126a0e52e75f1e3d535d0fb0d33c) = mysql_fetch_row($result)) {$v6f8f57715090da2632453988d9a1501b = $this->doc->createElement('module');$v6f8f57715090da2632453988d9a1501b->setAttribute('name', $v22884db148f0ffb0d830ba431102b0b5);$v6f8f57715090da2632453988d9a1501b->setAttribute('method', $vea9f6aca279138c58f705c8d4cb4b8ce);$v6f8f57715090da2632453988d9a1501b->setAttribute('allow', $vb394126a0e52e75f1e3d535d0fb0d33c);$v83878c91171338902e0fe0fb97a8c47a->appendChild($v6f8f57715090da2632453988d9a1501b);}$v83878c91171338902e0fe0fb97a8c47a->setAttribute('object-id', $vdad7dfa79a52fb5c76dff4c6bc0ddfe4);if ($v4a8a08f09d37b73795649038408b5f33->hasAttribute('ownerId')) {$v5e7b19364b8de2dedd3aa48cf62706e3 = $va8cfde6331bd59eb2ac96f8911c4b666->getOwnerId();if ($this->exportObject($v5e7b19364b8de2dedd3aa48cf62706e3)) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return true;}}$v72df47727f5cd9aca03aad866944cc2a = $this->relations->getOldObjectIdRelation($this->source_id, $v5e7b19364b8de2dedd3aa48cf62706e3);$v4a8a08f09d37b73795649038408b5f33->setAttribute('ownerId', $v72df47727f5cd9aca03aad866944cc2a);$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('owner');$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('id', $v72df47727f5cd9aca03aad866944cc2a);$v83878c91171338902e0fe0fb97a8c47a->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}$v9f5a2d64925838158f3ef0a206b58c00[] = $v83878c91171338902e0fe0fb97a8c47a;}foreach ($v5df80bc8ce306a564d91fa6a4da3d95b as $v4b43b0aee35624cd95b910189b3dc231) {$this->relations_container->appendChild($v4b43b0aee35624cd95b910189b3dc231);}foreach ($vc639bc918ec583ce6a914b6bbb29095d as $ve1671797c52e15f763380b45e841ec32) {$this->options_container->appendChild($ve1671797c52e15f763380b45e841ec32);}foreach ($v9f5a2d64925838158f3ef0a206b58c00 as $v83878c91171338902e0fe0fb97a8c47a) {$this->permissions_container->appendChild($v83878c91171338902e0fe0fb97a8c47a);}$this->objects_container->appendChild($v4a8a08f09d37b73795649038408b5f33);$this->exported_objects[$vaf31437ce61345f416579830a98c91e5] = $vaf31437ce61345f416579830a98c91e5;$this->position++;return true;}protected function exportOption($v06e3d36fa30cea095545139854ad1fb9, $ve1671797c52e15f763380b45e841ec32) {$v93da65a9fd0004d9477aeac024e08e15 = $v06e3d36fa30cea095545139854ad1fb9->getElementsByTagName('option');foreach ($v93da65a9fd0004d9477aeac024e08e15 as $vef3e30e070f70244fd6578d88a6b77ac) {$vd95679752134a2d9eb61dbd7b91c4bcc = $this->doc->createElement('option');if($vef3e30e070f70244fd6578d88a6b77ac->hasAttributes()) {$v736b91750e516139acc13c5eb6564f92 = $vef3e30e070f70244fd6578d88a6b77ac->attributes;if(!is_null($v736b91750e516139acc13c5eb6564f92)) {foreach ($v736b91750e516139acc13c5eb6564f92 as $v6a992d5529f459a44fee58c733255e86 => $vd2eb444e35c0a71f0a85df8194acb5b6) {$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute($vd2eb444e35c0a71f0a85df8194acb5b6->name, $vd2eb444e35c0a71f0a85df8194acb5b6->value);}}}if($vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('object')->length) {$va8cfde6331bd59eb2ac96f8911c4b666 = $vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('object')->item(0);if ($this->exportObject($va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vb80bb7740288fda1f201890375a60c8f = $this->relations->getOldObjectIdRelation($this->source_id, $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('id'));$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('object-id' , $vb80bb7740288fda1f201890375a60c8f);$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('id', $vb80bb7740288fda1f201890375a60c8f);if ($this->exportType($va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('type-id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('type-id'));$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);if ($va8cfde6331bd59eb2ac96f8911c4b666->hasAttribute('ownerId')) {if ($v5e7b19364b8de2dedd3aa48cf62706e3 = $va8cfde6331bd59eb2ac96f8911c4b666->getAttribute('ownerId')){if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$this->exportObject($v5e7b19364b8de2dedd3aa48cf62706e3);$v72df47727f5cd9aca03aad866944cc2a = $this->relations->getOldObjectIdRelation($this->source_id, $v5e7b19364b8de2dedd3aa48cf62706e3);$va8cfde6331bd59eb2ac96f8911c4b666->setAttribute('ownerId', $v72df47727f5cd9aca03aad866944cc2a);$va8cfde6331bd59eb2ac96f8911c4b666->removeAttribute('xlink:href');}}if($vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('page')->length) {$v71860c77c6745379b0d44304d66b6a13 = $vef3e30e070f70244fd6578d88a6b77ac->getElementsByTagName('page')->item(0);if ($this->exportPage($v71860c77c6745379b0d44304d66b6a13->getAttribute('id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$vb80bb7740288fda1f201890375a60c8f = $this->relations->getOldIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('id'));$vd95679752134a2d9eb61dbd7b91c4bcc->setAttribute('page-id' , $vb80bb7740288fda1f201890375a60c8f);$v71860c77c6745379b0d44304d66b6a13->setAttribute('id', $vb80bb7740288fda1f201890375a60c8f);if ($this->exportType($v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'))) {if ($this->limit && $this->position >= $this->limit) {$this->break = true;return false;}}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getOldTypeIdRelation($this->source_id, $v71860c77c6745379b0d44304d66b6a13->getAttribute('type-id'));$v71860c77c6745379b0d44304d66b6a13->setAttribute('type-id', $v94757cae63fd3e398c0811a976dd6bbe);$v71860c77c6745379b0d44304d66b6a13->removeAttribute('xlink:href');$v71860c77c6745379b0d44304d66b6a13->removeAttribute('update-time');}$ve1671797c52e15f763380b45e841ec32->appendChild($vd95679752134a2d9eb61dbd7b91c4bcc);}return true;}protected function exportElements() {foreach ($this->elements as $v7057e8409c7c531a1a6e9ac3df4ed549) {if ($this->break) return;$this->exportElement($v7057e8409c7c531a1a6e9ac3df4ed549);}}protected function exportObjects() {foreach ($this->objects as $vaf31437ce61345f416579830a98c91e5) {if ($this->break) return;$this->exportObject($vaf31437ce61345f416579830a98c91e5);}}protected function exportRegs() {foreach ($this->registry as $v33c0ee425e2c0efe834afc1aa1e33a4c) {if ($this->break) return;$this->exportReg($v33c0ee425e2c0efe834afc1aa1e33a4c);}}protected function exportDataTypes() {foreach ($this->data_types as $v17f71d965fe9589ddbd11caf7182243e) {if ($this->break) return;$this->exportDataType($v17f71d965fe9589ddbd11caf7182243e);}}}?>
