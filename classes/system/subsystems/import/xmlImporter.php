<?php
 class xmlImporter implements iXmlImporter {const VERSION = "2.0";const ROOT_PAGE_TYPE_ID = 3;protected $doc, $parser;protected $relations, $source_id;protected $destination_element_id = 0;protected $update_ignore = false;protected $demosite_mode = false;protected $meta = array();public  $updated_types = 0, $created_types = 0,     $updated_languages = 0, $created_languages = 0,     $updated_domains = 0, $created_domains = 0,     $updated_domain_mirrors = 0, $created_domain_mirrors = 0,     $updated_templates = 0, $created_templates = 0,     $updated_objects = 0, $created_objects = 0, $deleted_objects = 0,     $updated_elements = 0, $created_elements = 0, $deleted_elements = 0,     $copied_files = 0,     $update_relations = 0,     $created_restrictions = 0,     $created_registry_items = 0,     $created_permissions = 0,     $created_field_types = 0,     $created_dirs = 0,     $import_errors = 0;public $filesSource = false;public $ignoreParentGroups = true;public $auto_guide_creation = false;public $renameFiles = false;protected $import_log = array();protected $imported_elements = array();public function __construct($vaf721e88e6c0a612be51c329cb2bc12a = false) {if ($vaf721e88e6c0a612be51c329cb2bc12a) $this->meta['source-name'] = $vaf721e88e6c0a612be51c329cb2bc12a;$this->doc = new DomDocument("1.0", "utf-8");$this->relations = umiImportRelations::getInstance();}public function setUpdateIgnoreMode($vaae635b880d641a8298288912ea0dee8 = true) {$this->update_ignore = (bool) $vaae635b880d641a8298288912ea0dee8;}public function setAutoGuideCreation($v1584701c77c2a2d537c7b7410db75c5c = false) {$this->auto_guide_creation = (bool) $v1584701c77c2a2d537c7b7410db75c5c;}public function setRenameFiles($v82e493c80beeab7a6e841aa86ea2c6ad = false) {$this->renameFiles = (bool) $v82e493c80beeab7a6e841aa86ea2c6ad;}public function setDemositeMode ($vaf0ec91487469a949ca2e9ecad439be8 = true){$this->demosite_mode = $vaf0ec91487469a949ca2e9ecad439be8;}public function loadXmlString($v2d04a630b197c6991c3e00e003f88be4) {return $this->doc->loadXML($v2d04a630b197c6991c3e00e003f88be4, DOM_LOAD_OPTIONS);}protected function getLabel($i18n) {$vd304ba20e96d87411588eeabac850e34 = getLabel($i18n);if (!$vd304ba20e96d87411588eeabac850e34 || $vd304ba20e96d87411588eeabac850e34 == $i18n) {$vd304ba20e96d87411588eeabac850e34 = str_replace('label-', '', $i18n);$vd304ba20e96d87411588eeabac850e34 = preg_replace("/(.*?)-[m,f,n]+$/", "$1", $vd304ba20e96d87411588eeabac850e34);$vd304ba20e96d87411588eeabac850e34 = str_replace('-', ' ', $vd304ba20e96d87411588eeabac850e34);}return $vd304ba20e96d87411588eeabac850e34;}public function loadXmlFile($va30c2e8bafac20e81c697b2396c8a3b0) {if(!is_file($va30c2e8bafac20e81c697b2396c8a3b0)) {throw new publicException($this->getLabel('label-cannot-read-file') . ' ' . $va30c2e8bafac20e81c697b2396c8a3b0);}return $this->doc->load($va30c2e8bafac20e81c697b2396c8a3b0, DOM_LOAD_OPTIONS);}public function loadXmlDocument(DOMDocument $v9a09b4dfda82e3e665e31092d1c3ec8d) {$this->doc = $v9a09b4dfda82e3e665e31092d1c3ec8d;}public function setDestinationElement($v8e2dcfd7e7e24b1ca76c1193f645902b) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();return true;}if (umiHierarchy::getInstance()->getElement($v8e2dcfd7e7e24b1ca76c1193f645902b, true, true) instanceof umiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b;return true;}return false;}public function execute() {$va59fd5768bddc123092dddd6413dff0e = cmsController::$IGNORE_MICROCACHE;$v2b419278ae6ec25f1deac5b2319d2f2c = umiObjectProperty::$IGNORE_FILTER_INPUT_STRING;cmsController::$IGNORE_MICROCACHE = true;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = true;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if(!$v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'import-auto-index')) {if(!defined('DISABLE_SEARCH_REINDEX')) {define('DISABLE_SEARCH_REINDEX', 1);}}$v62b7dedcccf830f9a5e3a602bbd23deb = umiObjectProperty::$USE_FORCE_OBJECTS_CREATION;if ($this->auto_guide_creation) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}else {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;}$this->parser = new DOMXPath($this->doc);$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/@version");$v2af72f100c356273d46284f6fd1dfc08 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";if ($v2af72f100c356273d46284f6fd1dfc08 != self::VERSION) {throw new publicException($this->getLabel("label-unknown-umidump-version"));}$this->parseMetaData();$this->source_id = $this->relations->getSourceId($this->meta['source-name']);if (!$this->source_id) {$this->source_id = $this->relations->addNewSource($this->meta['source-name']);}$this->importRegistry();$this->importDirs();if ($this->filesSource) $this->importFiles();$this->importLangs();$this->importDomains();$this->importTemplates();$this->importDataTypes();$this->importTypes();$this->importObjects();$this->importElements();$this->importRelations();$this->importOptions();$this->importRestrictions();$this->setDefaultPermissions();$this->importPermissions();$this->importHierarchy();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = $v62b7dedcccf830f9a5e3a602bbd23deb;cmsController::$IGNORE_MICROCACHE = $va59fd5768bddc123092dddd6413dff0e;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = $v2b419278ae6ec25f1deac5b2319d2f2c;}public function setFilesSource($vd2c10d5f8f2397b7c8ed983609e71e27) {if(!is_dir($vd2c10d5f8f2397b7c8ed983609e71e27)) {throw new coreException($this->getLabel("label-cannot-find-files-source"));}$this->filesSource = $vd2c10d5f8f2397b7c8ed983609e71e27;}public function setIgnoreParentGroups($va0913828f00eefe560bcf007c7ae015a) {$this->ignoreParentGroups = $va0913828f00eefe560bcf007c7ae015a;}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {$this->import_errors++;if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $vcb5e100e5a9a3e7f6d1fd97512215282 . "\n\r";else $this->import_log[] = "<font style='color:red''>" . $vcb5e100e5a9a3e7f6d1fd97512215282 . "</font>";}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) echo $v78e731027d8fd50ed642340b7c9a63b3 . "\n\r";else $this->import_log[] = $v78e731027d8fd50ed642340b7c9a63b3;}public function getImportLog() {return $this->import_log;}protected function parseMetaData() {$v6f8f57715090da2632453988d9a1501b = $this->meta;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/site-name");$v6f8f57715090da2632453988d9a1501b['site-name'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/domain");$v6f8f57715090da2632453988d9a1501b['domain'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/lang");$v6f8f57715090da2632453988d9a1501b['lang'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";if (!isset($v6f8f57715090da2632453988d9a1501b['source-name'])) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/source-name");$v6f8f57715090da2632453988d9a1501b['source-name'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : md5($v6f8f57715090da2632453988d9a1501b['domain']);}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/generate-time/timestamp");$v6f8f57715090da2632453988d9a1501b['generated'] =  $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : "";$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/meta/branches/id");$v6f8f57715090da2632453988d9a1501b['branches'] = array();foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v36c4536996ca5615dcf9911f068786dc) {$v6f8f57715090da2632453988d9a1501b['branches'][] = $v36c4536996ca5615dcf9911f068786dc->nodeValue;}$this->meta = $v6f8f57715090da2632453988d9a1501b;}protected function importHierarchyType($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942, $v42c20047918d7af7031377b1461d197a) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchyTypesCollection::getInstance();$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942);if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$vb80bb7740288fda1f201890375a60c8f = $vdb6d9b451b818ccc9a449383f2f0c450->addType($v568e2307c59466ef505aab734d74f1f9, $v42c20047918d7af7031377b1461d197a, $va85c62c99bf80aeffb74914fb56a1942);$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942);}if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {throw new coreException($this->getLabel("label-cannot-create-hierarchy-type") . "{$v568e2307c59466ef505aab734d74f1f9}/{$va85c62c99bf80aeffb74914fb56a1942} ({$v42c20047918d7af7031377b1461d197a})");}return $v89b0b9deff65f8b9cd1f71bc74ce36ba;}protected function importTypes() {$va3032d293cbe70eef8203ae3c3ecc30c = $this->parser->evaluate("/umidump/types/type");foreach ($va3032d293cbe70eef8203ae3c3ecc30c as $veea7dc04e9c0c2c050fea3f8340c661b) {$this->importType($veea7dc04e9c0c2c050fea3f8340c661b);}}protected function importType(DOMElement $veea7dc04e9c0c2c050fea3f8340c661b) {$v61ce6a78cb3c8547fed20990c92edfe3 = $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('id');$v22178d66649d30b18a7e4e331dc778ce = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('title') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('title') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-type') . " \"{$v22178d66649d30b18a7e4e331dc778ce}\" " . $this->getLabel('label-with-empty-id'));return false;}$vd33d1e928d54a353100641ff7d704306 = $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('parent-id');$v7617e8d03bb811f5c37135234006b114 = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('guide') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('guide') : null;$v117256556af3bd1a0c9710a593d93814 = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('public') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('public') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('locked') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('locked') : null;$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $veea7dc04e9c0c2c050fea3f8340c661b->hasAttribute('guid') ? $veea7dc04e9c0c2c050fea3f8340c661b->getAttribute('guid') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v69203671ddb68b3848f87700fe06de55 = false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) {$v69203671ddb68b3848f87700fe06de55 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($v69203671ddb68b3848f87700fe06de55 && $v69203671ddb68b3848f87700fe06de55 != $this->relations->getNewTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v69203671ddb68b3848f87700fe06de55);}}if (!$v69203671ddb68b3848f87700fe06de55) $v69203671ddb68b3848f87700fe06de55 = $this->relations->getNewTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v69203671ddb68b3848f87700fe06de55 && $this->update_ignore) {$this->writeLog($this->getLabel("label-datatype") . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" ". $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);}if(!$v69203671ddb68b3848f87700fe06de55) {$vbb05d2aa96d31d1d44eb6ef550686607 = (trim($vd33d1e928d54a353100641ff7d704306, "{}") == 'root-pages-type') ? $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-pages-type') : $this->relations->getNewTypeIdRelation($this->source_id, $vd33d1e928d54a353100641ff7d704306);if (is_null($v22178d66649d30b18a7e4e331dc778ce)) {$v22178d66649d30b18a7e4e331dc778ce = "Type #" . $v61ce6a78cb3c8547fed20990c92edfe3;}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("base", $veea7dc04e9c0c2c050fea3f8340c661b);$v593616de15330c0fb2d55e55410bf994 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0) : false;$v568e2307c59466ef505aab734d74f1f9 = $v593616de15330c0fb2d55e55410bf994 ? $v593616de15330c0fb2d55e55410bf994->getAttribute('module') : false;$va85c62c99bf80aeffb74914fb56a1942 = $v593616de15330c0fb2d55e55410bf994 ? $v593616de15330c0fb2d55e55410bf994->getAttribute('method') : false;$v42c20047918d7af7031377b1461d197a = $v593616de15330c0fb2d55e55410bf994->nodeValue;$v89b0b9deff65f8b9cd1f71bc74ce36ba = false;if (strlen($v568e2307c59466ef505aab734d74f1f9)) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $this->importHierarchyType($v568e2307c59466ef505aab734d74f1f9, $va85c62c99bf80aeffb74914fb56a1942, $v42c20047918d7af7031377b1461d197a);$v75b212f033271dc4a7b372cebf3f0e9f = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());$v152163c4320bc49594f3ac21600886b1 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v75b212f033271dc4a7b372cebf3f0e9f);if (trim($vd33d1e928d54a353100641ff7d704306, "{}") == 'root-pages-type' && $v152163c4320bc49594f3ac21600886b1 instanceof umiObjectType) {$v69203671ddb68b3848f87700fe06de55 = $v152163c4320bc49594f3ac21600886b1->getId();}elseif (!$vbb05d2aa96d31d1d44eb6ef550686607 && $v152163c4320bc49594f3ac21600886b1 instanceof umiObjectType) {$vbb05d2aa96d31d1d44eb6ef550686607 = $v152163c4320bc49594f3ac21600886b1->getId();}}if (!$v69203671ddb68b3848f87700fe06de55) $v69203671ddb68b3848f87700fe06de55 = $vdb6d9b451b818ccc9a449383f2f0c450->addType(intval($vbb05d2aa96d31d1d44eb6ef550686607), trim($v22178d66649d30b18a7e4e331dc778ce), false, $this->ignoreParentGroups);$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba) $v599dcce2998a6b40b1e38e8c6006cb0a->setHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());$ve2fa538867c3830a859a5b17ab24644b = true;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55)->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);$this->relations->setTypeIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v69203671ddb68b3848f87700fe06de55);}$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v69203671ddb68b3848f87700fe06de55);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-detect-type') . $this->getLabel('label-datatype') . "{$v22178d66649d30b18a7e4e331dc778ce} ({$v61ce6a78cb3c8547fed20990c92edfe3})");return false;}if (!is_null($v22178d66649d30b18a7e4e331dc778ce)) $v599dcce2998a6b40b1e38e8c6006cb0a->setName(trim($v22178d66649d30b18a7e4e331dc778ce));if (!is_null($v117256556af3bd1a0c9710a593d93814)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsPublic($v117256556af3bd1a0c9710a593d93814 == 'public' || $v117256556af3bd1a0c9710a593d93814 == "1");if (!is_null($v7617e8d03bb811f5c37135234006b114)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsGuidable($v7617e8d03bb811f5c37135234006b114 == 'guide' || $v7617e8d03bb811f5c37135234006b114 == "1");if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $v599dcce2998a6b40b1e38e8c6006cb0a->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == "1");$v599dcce2998a6b40b1e38e8c6006cb0a->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_types++;$this->writeLog($this->getLabel('label-datatype') . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-created-m'));}else {$this->updated_types++;$this->writeLog($this->getLabel('label-datatype') . " \"" . $v22178d66649d30b18a7e4e331dc778ce . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-updated-m'));}$this->importTypeGroups($v599dcce2998a6b40b1e38e8c6006cb0a, $veea7dc04e9c0c2c050fea3f8340c661b);return $v599dcce2998a6b40b1e38e8c6006cb0a;}protected function importTypeGroups(umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $veea7dc04e9c0c2c050fea3f8340c661b) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("fieldgroups/group", $veea7dc04e9c0c2c050fea3f8340c661b);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v562feb4548b66febf02774b4f339552e) {$this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $v562feb4548b66febf02774b4f339552e);}}protected function importTypeGroup(umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $v562feb4548b66febf02774b4f339552e, $v329edef3a633f06f22708df738e30eb2 = true) {$v8fe62617c470a7a0465d0ccd7c6970f6 = $v562feb4548b66febf02774b4f339552e->getAttribute('name');if (!strlen($v8fe62617c470a7a0465d0ccd7c6970f6)) return false;$ve9ee6daff5c35c1c3ebd7adf00db810e = self::translateName($v8fe62617c470a7a0465d0ccd7c6970f6);$vd5d3db1765287eef77d7927cc956f50a = $v562feb4548b66febf02774b4f339552e->hasAttribute('title') ? $v562feb4548b66febf02774b4f339552e->getAttribute('title') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v562feb4548b66febf02774b4f339552e->hasAttribute('visible') ? $v562feb4548b66febf02774b4f339552e->getAttribute('visible') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $v562feb4548b66febf02774b4f339552e->hasAttribute('locked') ? $v562feb4548b66febf02774b4f339552e->getAttribute('locked') : null;$v4264c638e0098acb172519b0436db099 = $v562feb4548b66febf02774b4f339552e->hasAttribute('active') ? $v562feb4548b66febf02774b4f339552e->getAttribute('active') : null;$vdb0f6f37ebeb6ea09489124345af2a45 = null;$v0e939a4ffd3aacd724dd3b50147b4353 = $this->relations->getNewGroupId($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6);if ($v0e939a4ffd3aacd724dd3b50147b4353) $vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v0e939a4ffd3aacd724dd3b50147b4353, true);if (!$v0e939a4ffd3aacd724dd3b50147b4353) {$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupByName($ve9ee6daff5c35c1c3ebd7adf00db810e, true);if ($vdb0f6f37ebeb6ea09489124345af2a45) $this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6, $vdb0f6f37ebeb6ea09489124345af2a45->getId());}if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {if (is_null($vd5d3db1765287eef77d7927cc956f50a)) {$vd5d3db1765287eef77d7927cc956f50a = "Group #" . $v8fe62617c470a7a0465d0ccd7c6970f6;}$v0e939a4ffd3aacd724dd3b50147b4353 = $v599dcce2998a6b40b1e38e8c6006cb0a->addFieldsGroup($ve9ee6daff5c35c1c3ebd7adf00db810e, trim($vd5d3db1765287eef77d7927cc956f50a), true, false);$this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v8fe62617c470a7a0465d0ccd7c6970f6, $v0e939a4ffd3aacd724dd3b50147b4353);$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v0e939a4ffd3aacd724dd3b50147b4353, true);}if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) {$this->reportError($this->getLabel('label-cannot-import-group') . "{$v8fe62617c470a7a0465d0ccd7c6970f6}:" . $this->getLabel('label-cannot-detect-group'));return false;}if (!is_null($vd5d3db1765287eef77d7927cc956f50a)) $vdb0f6f37ebeb6ea09489124345af2a45->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == '1');if (!is_null($v4264c638e0098acb172519b0436db099)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsActive($v4264c638e0098acb172519b0436db099 == 'active' || $v4264c638e0098acb172519b0436db099 == '1');if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $vdb0f6f37ebeb6ea09489124345af2a45->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == '1');$vdb0f6f37ebeb6ea09489124345af2a45->commit();if ($v329edef3a633f06f22708df738e30eb2) $this->importGroupFields($vdb0f6f37ebeb6ea09489124345af2a45, $v562feb4548b66febf02774b4f339552e);return $vdb0f6f37ebeb6ea09489124345af2a45;}protected function importGroupFields(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $v562feb4548b66febf02774b4f339552e) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("field", $v562feb4548b66febf02774b4f339552e);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v3906452ac57c71c3f053666f9c0e8355) {$this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $v3906452ac57c71c3f053666f9c0e8355);}}protected function getFieldByName(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, $vb068931cc450442b63f5b3d276ea4297) {$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $vb068931cc450442b63f5b3d276ea4297) return $v06e3d36fa30cea095545139854ad1fb9;}return false;}protected function importFieldType($vfaf701ce237284ac6be752513db01dcd) {$vb068931cc450442b63f5b3d276ea4297 = $vfaf701ce237284ac6be752513db01dcd->getAttribute('name');$v17f71d965fe9589ddbd11caf7182243e = $vfaf701ce237284ac6be752513db01dcd->getAttribute('data-type');$vce495ab8d79db0d37413d8e95b54e606 = $vfaf701ce237284ac6be752513db01dcd->getAttribute('multiple') == 1 || $vfaf701ce237284ac6be752513db01dcd->getAttribute('multiple') == "multiple";if (!strlen($v17f71d965fe9589ddbd11caf7182243e)) return false;$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v17f71d965fe9589ddbd11caf7182243e, $vce495ab8d79db0d37413d8e95b54e606);$ve2fa538867c3830a859a5b17ab24644b = false;if (!$v519504d7d4beb745dac24ccfb6c1d7c9 instanceof  umiFieldType) {$v1e3f04102267eaf5e8d0ca424fd5c561 = $vdb6d9b451b818ccc9a449383f2f0c450->addFieldType($vb068931cc450442b63f5b3d276ea4297, $v17f71d965fe9589ddbd11caf7182243e);$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldType($v1e3f04102267eaf5e8d0ca424fd5c561);$v519504d7d4beb745dac24ccfb6c1d7c9->setIsMultiple($vce495ab8d79db0d37413d8e95b54e606);$v519504d7d4beb745dac24ccfb6c1d7c9->commit();$ve2fa538867c3830a859a5b17ab24644b = true;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_field_types++;$this->writeLog($this->getLabel('label-field-type') . "\"" . $v519504d7d4beb745dac24ccfb6c1d7c9->getName() . "\"" . $this->getLabel('label-has-been-created-m'));}return $v519504d7d4beb745dac24ccfb6c1d7c9;}public function getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a) {$vcf4313ee98665bb3d4b717b344ba6999 = "Справочник для поля \"{$vd5d3db1765287eef77d7927cc956f50a}\"";$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$va08f2aee9de301619776deb6fee83e50 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-guides-type');$v2af1d1812273df0bd0f720da7068f8a6 = $vdb6d9b451b818ccc9a449383f2f0c450->getChildClasses($va08f2aee9de301619776deb6fee83e50);foreach($v2af1d1812273df0bd0f720da7068f8a6 as $vd4fd255f51559df00de5424b64292413) {$v793536b8480511c5e2975eba32738d1d = $vdb6d9b451b818ccc9a449383f2f0c450->getType($vd4fd255f51559df00de5424b64292413);$vfd297f4a9a622aec6f6fb2589b9cda82 = $v793536b8480511c5e2975eba32738d1d->getName();if($vfd297f4a9a622aec6f6fb2589b9cda82 == $vcf4313ee98665bb3d4b717b344ba6999) {$v793536b8480511c5e2975eba32738d1d->setIsGuidable(true);return $vd4fd255f51559df00de5424b64292413;}}$v051369818a8073bba5feeb0e957eb308 = $vdb6d9b451b818ccc9a449383f2f0c450->addType($va08f2aee9de301619776deb6fee83e50, $vcf4313ee98665bb3d4b717b344ba6999);$va0c391dc49c440fc9962168353cedde3 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v051369818a8073bba5feeb0e957eb308);$va0c391dc49c440fc9962168353cedde3->setIsGuidable(true);$va0c391dc49c440fc9962168353cedde3->setIsPublic(true);$va0c391dc49c440fc9962168353cedde3->commit();return $v051369818a8073bba5feeb0e957eb308;}protected function importField(umiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $v3906452ac57c71c3f053666f9c0e8355) {$v6adb6b0ad1941d569b23e089910c5e74 = $v3906452ac57c71c3f053666f9c0e8355->getAttribute('name');if (!strlen($v6adb6b0ad1941d569b23e089910c5e74)) {$this->reportError($this->getLabel('label-cannot-import-field-with-empty-name'));return false;}$vd5d3db1765287eef77d7927cc956f50a = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('title') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('title') : null;$v6a2139364f96787c8ce1bbb0070b898c = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('tip') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('tip') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('visible') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('visible') : null;$v1945c9a2a5e2ba6133f1db6757a35fcb = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('locked') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('locked') : null;$vd5752333adc3a004f826f2ea2a41273a = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('inheritable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('inheritable') : null;$ved5d0cbca24ec1fe6d0ab89a566dc9c1 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('indexable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('indexable') : null;$va0b3cf76e59b5c67b3ea226dd76adf9b = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('filterable') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('filterable') : null;$v0d2ac6f3b02c0de484369013b31f2ed7 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('required') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('required') : null;$vc9409711ebff9250bd075037d3d18263 = $v3906452ac57c71c3f053666f9c0e8355->hasAttribute('system') ? $v3906452ac57c71c3f053666f9c0e8355->getAttribute('system') : null;$v17d0db9e12e990d49216a42e1451f46e = self::translateName($v6adb6b0ad1941d569b23e089910c5e74);$v87306dd4235ed712ebc07fe169b76f83 = $vdb0f6f37ebeb6ea09489124345af2a45->getTypeId();$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldsCollection::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$v06e3d36fa30cea095545139854ad1fb9 = null;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("type", $v3906452ac57c71c3f053666f9c0e8355);$vfaf701ce237284ac6be752513db01dcd = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0): false;if (!$vfaf701ce237284ac6be752513db01dcd) {$this->reportError($this->getLabel('label-cannot-import-field') . " {$v6adb6b0ad1941d569b23e089910c5e74}: " . $this->getLabel('label-cannot-detect-datatype'));return false;}$v519504d7d4beb745dac24ccfb6c1d7c9 = $this->importFieldType($vfaf701ce237284ac6be752513db01dcd);if (!$v519504d7d4beb745dac24ccfb6c1d7c9 instanceof umiFieldType) {$this->reportError($this->getLabel('label-cannot-detect-field-type-for') . " {$v6adb6b0ad1941d569b23e089910c5e74}");return false;}$v1e3f04102267eaf5e8d0ca424fd5c561 = $v519504d7d4beb745dac24ccfb6c1d7c9->getId();$v7ae7003da59ae71dcc9f8638ef50593d = $v953e1ee8066af1b7e55300750533ddc8->getType($v87306dd4235ed712ebc07fe169b76f83);$v3aabf39f2d943fa886d86dcbbee4d910 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false);if ($v3aabf39f2d943fa886d86dcbbee4d910) {$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v3aabf39f2d943fa886d86dcbbee4d910);if($v06e3d36fa30cea095545139854ad1fb9 instanceof umiField && $v3aabf39f2d943fa886d86dcbbee4d910 != $this->relations->getNewFieldId($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74)){$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v3aabf39f2d943fa886d86dcbbee4d910);}}if(!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v2e3c048401582f4247d7ccac43657d2d = $v7ae7003da59ae71dcc9f8638ef50593d->getParentId();if ($v2e3c048401582f4247d7ccac43657d2d) {$v328a21868fce2b3f8569db40f1aa8a89 = $v953e1ee8066af1b7e55300750533ddc8->getType($v2e3c048401582f4247d7ccac43657d2d);$v1151783f57c3e0768f301e7fbf1c67f2 = $v328a21868fce2b3f8569db40f1aa8a89->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false);if ($v1151783f57c3e0768f301e7fbf1c67f2) {$v239407987de466be3f94ce70d7139134 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v1151783f57c3e0768f301e7fbf1c67f2, false);if ($v239407987de466be3f94ce70d7139134->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561 && $v239407987de466be3f94ce70d7139134->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $v239407987de466be3f94ce70d7139134;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v1151783f57c3e0768f301e7fbf1c67f2);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v06e3d36fa30cea095545139854ad1fb9->getId());}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$v3f5af10cbb47cb1b6fcf196befc17b95 = $v953e1ee8066af1b7e55300750533ddc8->getSubTypesList($v2e3c048401582f4247d7ccac43657d2d);foreach($v3f5af10cbb47cb1b6fcf196befc17b95 as $veb2c84964aa55a68255b7466cd21b62c) {if($veb2c84964aa55a68255b7466cd21b62c == $v87306dd4235ed712ebc07fe169b76f83) continue;$v4ae5fdeb89c7a5a5daf33112bda3f82b = $v953e1ee8066af1b7e55300750533ddc8->getType($veb2c84964aa55a68255b7466cd21b62c);if($v4ae5fdeb89c7a5a5daf33112bda3f82b instanceof umiObjectType == false) continue;if($v6270c3e00735121953b8585fd836af43 = $v4ae5fdeb89c7a5a5daf33112bda3f82b->getFieldId($v17d0db9e12e990d49216a42e1451f46e, false)) {$vd3b250b73d77cb502490809548ef475e = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v6270c3e00735121953b8585fd836af43);if($vd3b250b73d77cb502490809548ef475e instanceof umiField == false) continue;if ($vd3b250b73d77cb502490809548ef475e->getFieldTypeId() == $v1e3f04102267eaf5e8d0ca424fd5c561 && $vd3b250b73d77cb502490809548ef475e->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $vd3b250b73d77cb502490809548ef475e;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v6270c3e00735121953b8585fd836af43);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v06e3d36fa30cea095545139854ad1fb9->getId());break;}}}}}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {if (is_null($vd5d3db1765287eef77d7927cc956f50a)) {$vd5d3db1765287eef77d7927cc956f50a = $v6adb6b0ad1941d569b23e089910c5e74;}$v3aabf39f2d943fa886d86dcbbee4d910 = $vdb6d9b451b818ccc9a449383f2f0c450->addField($v17d0db9e12e990d49216a42e1451f46e, trim($vd5d3db1765287eef77d7927cc956f50a), $v1e3f04102267eaf5e8d0ca424fd5c561, false, false, false);$this->relations->setFieldIdRelation($this->source_id, $v87306dd4235ed712ebc07fe169b76f83, $v6adb6b0ad1941d569b23e089910c5e74, $v3aabf39f2d943fa886d86dcbbee4d910);$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v3aabf39f2d943fa886d86dcbbee4d910);$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4);if (is_null($va0b3cf76e59b5c67b3ea226dd76adf9b)) $v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va0b3cf76e59b5c67b3ea226dd76adf9b);if (is_null($ved5d0cbca24ec1fe6d0ab89a566dc9c1)) $v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($ved5d0cbca24ec1fe6d0ab89a566dc9c1);}if (($v519504d7d4beb745dac24ccfb6c1d7c9->getDataType() == 'relation' || $v519504d7d4beb745dac24ccfb6c1d7c9->getDataType() == 'optioned') && $this->auto_guide_creation) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($this->getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a));}if ($v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId() != $v1e3f04102267eaf5e8d0ca424fd5c561) $v06e3d36fa30cea095545139854ad1fb9->setFieldTypeId($v1e3f04102267eaf5e8d0ca424fd5c561);if (!is_null($vd5d3db1765287eef77d7927cc956f50a)) $v06e3d36fa30cea095545139854ad1fb9->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v06e3d36fa30cea095545139854ad1fb9->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == "1");if (!is_null($ved5d0cbca24ec1fe6d0ab89a566dc9c1)) $v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($ved5d0cbca24ec1fe6d0ab89a566dc9c1 == 'indexable' || $ved5d0cbca24ec1fe6d0ab89a566dc9c1 == "1");if (!is_null($va0b3cf76e59b5c67b3ea226dd76adf9b)) $v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va0b3cf76e59b5c67b3ea226dd76adf9b == 'filterable' || $va0b3cf76e59b5c67b3ea226dd76adf9b == "1");if (!is_null($v0d2ac6f3b02c0de484369013b31f2ed7)) $v06e3d36fa30cea095545139854ad1fb9->setIsRequired($v0d2ac6f3b02c0de484369013b31f2ed7 == 'required' || $v0d2ac6f3b02c0de484369013b31f2ed7 == "1");if (!is_null($vc9409711ebff9250bd075037d3d18263)) $v06e3d36fa30cea095545139854ad1fb9->setIsSystem($vc9409711ebff9250bd075037d3d18263 == 'system' || $vc9409711ebff9250bd075037d3d18263 == "1");if (!is_null($v6a2139364f96787c8ce1bbb0070b898c)) $v06e3d36fa30cea095545139854ad1fb9->setTip(trim($v6a2139364f96787c8ce1bbb0070b898c));if (!is_null($v1945c9a2a5e2ba6133f1db6757a35fcb)) $v06e3d36fa30cea095545139854ad1fb9->setIsLocked($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == "1");if (!is_null($vd5752333adc3a004f826f2ea2a41273a)) $v06e3d36fa30cea095545139854ad1fb9->setIsInheritable($vd5752333adc3a004f826f2ea2a41273a == 'inheritable' || $vd5752333adc3a004f826f2ea2a41273a == "1");$ve4c9479b11955648dad558fe717a4eb2 = $this->parser->evaluate("tip", $v3906452ac57c71c3f053666f9c0e8355);$v6a2139364f96787c8ce1bbb0070b898c = $ve4c9479b11955648dad558fe717a4eb2->length ? $ve4c9479b11955648dad558fe717a4eb2->item(0): false;if ($v6a2139364f96787c8ce1bbb0070b898c) $v06e3d36fa30cea095545139854ad1fb9->setTip($v6a2139364f96787c8ce1bbb0070b898c->nodeValue);$v06e3d36fa30cea095545139854ad1fb9->commit();return $v06e3d36fa30cea095545139854ad1fb9;}protected function importBranches() {foreach ($this->meta['branches'] as $vb80bb7740288fda1f201890375a60c8f) {$this->importBranch($vb80bb7740288fda1f201890375a60c8f);}}protected function importElements() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importElement($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importBranch($vb80bb7740288fda1f201890375a60c8f) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page[@id = '" . $vb80bb7740288fda1f201890375a60c8f . "']");if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length) return false;$this->importElement($v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0));$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/pages/page[@parentId = '" . $vb80bb7740288fda1f201890375a60c8f . "']");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$vf36263a38d7de5cdaa953c1e2b2f79b5 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if ($vf36263a38d7de5cdaa953c1e2b2f79b5) $this->importBranch($vf36263a38d7de5cdaa953c1e2b2f79b5);}}protected function detectTemplateId($v6a2a431fe8b621037ea949531c28551d, $v662cbf1253ac7d8750ed9190c52163e5 = false, $v78e6dd7a49f5b0cb2106a3a434dd5c86 = false) {if($v6a2a431fe8b621037ea949531c28551d) {if ($v662cbf1253ac7d8750ed9190c52163e5 === false) $v662cbf1253ac7d8750ed9190c52163e5 = cmsController::getInstance()->getCurrentDomain()->getId();if ($v78e6dd7a49f5b0cb2106a3a434dd5c86 === false) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$vfed36e93a0509e20f2dc96cbbd85b678 = templatesCollection::getInstance()->getTemplatesList($v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);foreach($vfed36e93a0509e20f2dc96cbbd85b678 as $v4f96c7bc828b57b4a3b2b327a7a183c6) {if($v4f96c7bc828b57b4a3b2b327a7a183c6->getFilename() == $v6a2a431fe8b621037ea949531c28551d) {return $v4f96c7bc828b57b4a3b2b327a7a183c6->getId();}}}return false;}protected function importHierarchyRelation(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd33d1e928d54a353100641ff7d704306 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('parent-id');$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('ord');$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->relations->getNewIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($vd33d1e928d54a353100641ff7d704306) {$v6be379826b20cc58475f636e33f4606b = $this->relations->getNewIdRelation($this->source_id, $vd33d1e928d54a353100641ff7d704306);}else {$v6be379826b20cc58475f636e33f4606b = $this->destination_element_id;}if($v7057e8409c7c531a1a6e9ac3df4ed549) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchy::getInstance();$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;if ($v6be379826b20cc58475f636e33f4606b !== false) $v8e2dcfd7e7e24b1ca76c1193f645902b->setRel($v6be379826b20cc58475f636e33f4606b);if ($v8bef1cc20ada3bef55fdf132cb2a1cb9) $v8e2dcfd7e7e24b1ca76c1193f645902b->setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}}protected function importElement(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id');$vdff819de3d610895b1bdf4168281488c = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('update-only') == '1';$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('name');$vb068931cc450442b63f5b3d276ea4297 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : false;$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('template');$v66f6181bcb4cff4cd38fbc804a036db6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->length ? $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError("Can't create element \"{$vb068931cc450442b63f5b3d276ea4297}\" with empty id");return false;}$vd84ff935144e00c3e1d395c2379aca47 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('alt-name');if (!strlen($vd84ff935144e00c3e1d395c2379aca47)) $vd84ff935144e00c3e1d395c2379aca47 = $vb068931cc450442b63f5b3d276ea4297;$v4264c638e0098acb172519b0436db099 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-active') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-active') : null;$vd33d1e928d54a353100641ff7d704306 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('parentId') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('parentId') : null;$ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-visible') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-visible') : null;$vf49e2553045b3240a95c36854d36dddc = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-deleted') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-deleted') : null;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : false;$v662cbf1253ac7d8750ed9190c52163e5 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('domain-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('domain-id') : false;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : false;if($v662cbf1253ac7d8750ed9190c52163e5) $v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $v662cbf1253ac7d8750ed9190c52163e5);if($v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchy::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->relations->getNewIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v7057e8409c7c531a1a6e9ac3df4ed549 && $this->update_ignore) {$this->writeLog("Element \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) already exists");return $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);}if (!$v7057e8409c7c531a1a6e9ac3df4ed549) {if ($vdff819de3d610895b1bdf4168281488c) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) $vb068931cc450442b63f5b3d276ea4297 = $v61ce6a78cb3c8547fed20990c92edfe3;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6)) {$this->reportError($this->getLabel('label-cannot-create-element') . ": \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) ." . $this->getLabel('label-cannot-detect-type'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$v599dcce2998a6b40b1e38e8c6006cb0a = $v953e1ee8066af1b7e55300750533ddc8->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-create-element') . "\"{$vb068931cc450442b63f5b3d276ea4297}\" ($v61ce6a78cb3c8547fed20990c92edfe3): " . $this->getLabel('label-cannot-detect-type') . " #{$v5f6492d9717ccf1b8566bd4bc64110b6}");return false;}$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!regedit::getInstance()->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) return false;}}$v6be379826b20cc58475f636e33f4606b = false;if ($vd33d1e928d54a353100641ff7d704306) $v6be379826b20cc58475f636e33f4606b = $this->relations->getNewIdRelation($this->source_id, $vd33d1e928d54a353100641ff7d704306);if ($v6be379826b20cc58475f636e33f4606b === false) $v6be379826b20cc58475f636e33f4606b = $this->destination_element_id;$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("parent_id", $v6be379826b20cc58475f636e33f4606b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_element_id", $v61ce6a78cb3c8547fed20990c92edfe3);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("type", $v599dcce2998a6b40b1e38e8c6006cb0a);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);$v7057e8409c7c531a1a6e9ac3df4ed549 = $vdb6d9b451b818ccc9a449383f2f0c450->addElement($v6be379826b20cc58475f636e33f4606b, $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId(), $vb068931cc450442b63f5b3d276ea4297, $vd84ff935144e00c3e1d395c2379aca47, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$this->imported_elements[] = $v7057e8409c7c531a1a6e9ac3df4ed549;$this->relations->setIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v7057e8409c7c531a1a6e9ac3df4ed549);if (is_null($v4264c638e0098acb172519b0436db099)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-active');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $v4264c638e0098acb172519b0436db099 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}if (is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-visible');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}if (is_null($v66f6181bcb4cff4cd38fbc804a036db6)) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('default-template');if ($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) $v66f6181bcb4cff4cd38fbc804a036db6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)->nodeValue;}$ve2fa538867c3830a859a5b17ab24644b = true;}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) return false;if (!$ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}if ($vb068931cc450442b63f5b3d276ea4297) $v8e2dcfd7e7e24b1ca76c1193f645902b->setName($vb068931cc450442b63f5b3d276ea4297);if (!is_null($v4264c638e0098acb172519b0436db099)) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v4264c638e0098acb172519b0436db099 == 'active' || $v4264c638e0098acb172519b0436db099 == '1');if (!is_null($ve1c6c9ef2fcbe75f26f815c4ef2e60b4)) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible($ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == 'visible' || $ve1c6c9ef2fcbe75f26f815c4ef2e60b4 == '1');if ($vf62baf4c4ead98d50d516eca0ac5a746) $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746 == 'default' || $vf62baf4c4ead98d50d516eca0ac5a746 == '1');if (!is_null($v66f6181bcb4cff4cd38fbc804a036db6) && $vd02e12eb6d6c3f6ebd763197df01e211 = $this->detectTemplateId($v66f6181bcb4cff4cd38fbc804a036db6, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($vd02e12eb6d6c3f6ebd763197df01e211);}if ($ve2fa538867c3830a859a5b17ab24644b) {$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;if (!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId();$v5e3f5f5bf865de072ff1e4cd710d4a39 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);if ($v5e3f5f5bf865de072ff1e4cd710d4a39) {$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($v5e3f5f5bf865de072ff1e4cd710d4a39);if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectTypeId() == $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setObject($va8cfde6331bd59eb2ac96f8911c4b666);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();umiObjectsCollection::getInstance()->delObject($vaf31437ce61345f416579830a98c91e5);}else {$this->relations->setObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c, $vaf31437ce61345f416579830a98c91e5);}}else {$this->relations->setObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c, $vaf31437ce61345f416579830a98c91e5);}}}if ($vf49e2553045b3240a95c36854d36dddc == 'deleted' || $vf49e2553045b3240a95c36854d36dddc == '1') $v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDeleted(true);$this->importPropValues($v8e2dcfd7e7e24b1ca76c1193f645902b, $vcaf9b6b99962bf5c2264824231d7a40c, $ve2fa538867c3830a859a5b17ab24644b);if ($vf49e2553045b3240a95c36854d36dddc && ($vf49e2553045b3240a95c36854d36dddc == 'deleted' || $vf49e2553045b3240a95c36854d36dddc == '1')) {$this->deleted_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel("label-has-been-deleted-m"));}elseif ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel("label-has-been-created-f"));}elseif($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsUpdated()) {$this->updated_elements++;$this->writeLog($this->getLabel("label-page") . " \"" . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel("label-has-been-updated-f"));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}else {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateElement");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("element", $v8e2dcfd7e7e24b1ca76c1193f645902b);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$vdb6d9b451b818ccc9a449383f2f0c450->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);return $v8e2dcfd7e7e24b1ca76c1193f645902b;}protected function importLang(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$v851f5ac9941d720844d143ed9cfcf60a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('prefix') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('prefix') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = langsCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v468679bdf8f19aaf448fef664b7142b7 = $this->relations->getNewLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v468679bdf8f19aaf448fef664b7142b7) {if($v851f5ac9941d720844d143ed9cfcf60a) {$v468679bdf8f19aaf448fef664b7142b7 = $vdb6d9b451b818ccc9a449383f2f0c450->getLangId($v851f5ac9941d720844d143ed9cfcf60a);if ($v468679bdf8f19aaf448fef664b7142b7) $this->relations->setLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v468679bdf8f19aaf448fef664b7142b7);}}if (!$v468679bdf8f19aaf448fef664b7142b7) {if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;$v468679bdf8f19aaf448fef664b7142b7 = $vdb6d9b451b818ccc9a449383f2f0c450->addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a);$this->relations->setLangIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v468679bdf8f19aaf448fef664b7142b7);$ve2fa538867c3830a859a5b17ab24644b = true;}$v8512ae7d57b1396273f76fe6ed341a23 = $vdb6d9b451b818ccc9a449383f2f0c450->getLang($v468679bdf8f19aaf448fef664b7142b7);if (!$v8512ae7d57b1396273f76fe6ed341a23 instanceof lang) {$this->reportError($this->getLabel('label-cannot-detect-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" ");return false;}if ($vd5d3db1765287eef77d7927cc956f50a) $v8512ae7d57b1396273f76fe6ed341a23->setTitle($vd5d3db1765287eef77d7927cc956f50a);if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746) && $vf62baf4c4ead98d50d516eca0ac5a746) {$vdb6d9b451b818ccc9a449383f2f0c450->setDefault($v468679bdf8f19aaf448fef664b7142b7);}if (!is_null($v851f5ac9941d720844d143ed9cfcf60a)) $v8512ae7d57b1396273f76fe6ed341a23->setPrefix($v851f5ac9941d720844d143ed9cfcf60a);$v8512ae7d57b1396273f76fe6ed341a23->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_languages++;$this->writeLog($this->getLabel('label-language') . " \"" . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-updated-m'));}elseif($v8512ae7d57b1396273f76fe6ed341a23->getIsUpdated()) {$this->updated_languages++;$this->writeLog($this->getLabel('label-language') . " \"" . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-m'));}return $v8512ae7d57b1396273f76fe6ed341a23;}protected function importDomain(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$v67b3dba8bc6778101892eb77249db32e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('host') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('host') : null;$v596c3edc46f1e96c9f90a4b4cef2ac35 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : null;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = domainsCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v662cbf1253ac7d8750ed9190c52163e5) {if($v67b3dba8bc6778101892eb77249db32e) {$v662cbf1253ac7d8750ed9190c52163e5 = $vdb6d9b451b818ccc9a449383f2f0c450->getDomainId($v67b3dba8bc6778101892eb77249db32e);if ($v662cbf1253ac7d8750ed9190c52163e5) $this->relations->setDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v662cbf1253ac7d8750ed9190c52163e5);}}if ($v662cbf1253ac7d8750ed9190c52163e5 && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($v662cbf1253ac7d8750ed9190c52163e5);}if (!$v662cbf1253ac7d8750ed9190c52163e5) {if (!$v67b3dba8bc6778101892eb77249db32e) $v67b3dba8bc6778101892eb77249db32e = $v61ce6a78cb3c8547fed20990c92edfe3;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = false;if (!is_null($v596c3edc46f1e96c9f90a4b4cef2ac35)) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v596c3edc46f1e96c9f90a4b4cef2ac35);if (!$v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = langsCollection::getInstance()->getDefaultLang()->getId();$v662cbf1253ac7d8750ed9190c52163e5 = $vdb6d9b451b818ccc9a449383f2f0c450->addDomain($v67b3dba8bc6778101892eb77249db32e, $v78e6dd7a49f5b0cb2106a3a434dd5c86);$this->relations->setDomainIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v662cbf1253ac7d8750ed9190c52163e5);$ve2fa538867c3830a859a5b17ab24644b = true;}$vad5f82e879a9c5d6b5b442eb37e50551 = $vdb6d9b451b818ccc9a449383f2f0c450->getDomain($v662cbf1253ac7d8750ed9190c52163e5);if (!$vad5f82e879a9c5d6b5b442eb37e50551 instanceof domain) {$this->reportError($this->getLabel('label-cannot-detect-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" ");return false;}if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746) && $vf62baf4c4ead98d50d516eca0ac5a746) {if(!$vdb6d9b451b818ccc9a449383f2f0c450->getDefaultDomain()) $vdb6d9b451b818ccc9a449383f2f0c450->setDefaultDomain($v662cbf1253ac7d8750ed9190c52163e5);}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domains++;$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-m'));}elseif($vad5f82e879a9c5d6b5b442eb37e50551->getIsUpdated()) {$this->updated_domains++;$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") has been " . $this->getLabel('label-has-been-updated-m'));}$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('domain-mirror');foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDomainMirror($vcaf9b6b99962bf5c2264824231d7a40c, $vad5f82e879a9c5d6b5b442eb37e50551);}$vad5f82e879a9c5d6b5b442eb37e50551->commit();return $vad5f82e879a9c5d6b5b442eb37e50551;}protected function importDomainMirror(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, domain $vad5f82e879a9c5d6b5b442eb37e50551) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$v67b3dba8bc6778101892eb77249db32e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('host') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('host') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$ve2fa538867c3830a859a5b17ab24644b = false;$v1834e28d86200a836697541c12fa09bd = $this->relations->getNewDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if (!$v1834e28d86200a836697541c12fa09bd) {if (!is_null($v67b3dba8bc6778101892eb77249db32e)) {$v1834e28d86200a836697541c12fa09bd = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrowId($v67b3dba8bc6778101892eb77249db32e);if ($v1834e28d86200a836697541c12fa09bd) $this->relations->setDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v1834e28d86200a836697541c12fa09bd);}}if ($v1834e28d86200a836697541c12fa09bd && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vad5f82e879a9c5d6b5b442eb37e50551->getMirrow($v1834e28d86200a836697541c12fa09bd);}if (!$v1834e28d86200a836697541c12fa09bd) {if (is_null($v67b3dba8bc6778101892eb77249db32e)) $v67b3dba8bc6778101892eb77249db32e = $v61ce6a78cb3c8547fed20990c92edfe3;$v1834e28d86200a836697541c12fa09bd = $vad5f82e879a9c5d6b5b442eb37e50551->addMirrow($v67b3dba8bc6778101892eb77249db32e);$this->relations->setDomainMirrorIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v1834e28d86200a836697541c12fa09bd);$ve2fa538867c3830a859a5b17ab24644b = true;}$v95be0a2e6132b4fa2294808f7dbcc52a = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrow($v1834e28d86200a836697541c12fa09bd);if (!$v95be0a2e6132b4fa2294808f7dbcc52a instanceof domainMirrow) {$this->reportError($this->getLabel('label-cannot-detect-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\"");return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-n'));}elseif($v95be0a2e6132b4fa2294808f7dbcc52a->getIsUpdated()) {$this->updated_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . " \"" . $v67b3dba8bc6778101892eb77249db32e . "\" (#" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-updated-n'));}return $v95be0a2e6132b4fa2294808f7dbcc52a;}protected function importTemplate(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('title') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('title') : null;if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-template') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = templatesCollection::getInstance();$v435ed7e9f07f740abf511a62c00eef6e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('filename') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('filename') : null;$vee473c9da1c9449806dd22465b875ae8 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('domain-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('domain-id') : null;$v596c3edc46f1e96c9f90a4b4cef2ac35 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('lang-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('lang-id') : null;$vf62baf4c4ead98d50d516eca0ac5a746 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('is-default') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-default') : null;$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v599dcce2998a6b40b1e38e8c6006cb0a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('type') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type') : null;$v78e6dd7a49f5b0cb2106a3a434dd5c86 = false;$v662cbf1253ac7d8750ed9190c52163e5 = false;if (!is_null($v596c3edc46f1e96c9f90a4b4cef2ac35)) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = $this->relations->getNewLangIdRelation($this->source_id, $v596c3edc46f1e96c9f90a4b4cef2ac35);if (!is_null($vee473c9da1c9449806dd22465b875ae8)) $v662cbf1253ac7d8750ed9190c52163e5 = $this->relations->getNewDomainIdRelation($this->source_id, $vee473c9da1c9449806dd22465b875ae8);if(!$v78e6dd7a49f5b0cb2106a3a434dd5c86) $v78e6dd7a49f5b0cb2106a3a434dd5c86 = langsCollection::getInstance()->getDefaultLang()->getId();if(!$v662cbf1253ac7d8750ed9190c52163e5) $v662cbf1253ac7d8750ed9190c52163e5 = domainsCollection::getInstance()->getDefaultTemplate()->getId();$ve2fa538867c3830a859a5b17ab24644b = false;$v74f5356453a69e438e0f58ef93103cc0 = $this->relations->getNewTemplateIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($v74f5356453a69e438e0f58ef93103cc0 && $this->update_ignore) {$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v74f5356453a69e438e0f58ef93103cc0);}if (!$v74f5356453a69e438e0f58ef93103cc0) {if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;$v74f5356453a69e438e0f58ef93103cc0 = $this->detectTemplateId($v435ed7e9f07f740abf511a62c00eef6e, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86);if(!$v74f5356453a69e438e0f58ef93103cc0) $v74f5356453a69e438e0f58ef93103cc0 = $vdb6d9b451b818ccc9a449383f2f0c450->addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a);$this->relations->setTemplateIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v74f5356453a69e438e0f58ef93103cc0);$ve2fa538867c3830a859a5b17ab24644b = true;}$v66f6181bcb4cff4cd38fbc804a036db6 = $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v74f5356453a69e438e0f58ef93103cc0);if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof template) {$this->reportError($this->getLabel('label-cannot-detect-template') . "\"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if (!is_null($vf62baf4c4ead98d50d516eca0ac5a746)) $v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746);if (!is_null($vb068931cc450442b63f5b3d276ea4297)) $v66f6181bcb4cff4cd38fbc804a036db6->setName($vb068931cc450442b63f5b3d276ea4297);if (!is_null($v599dcce2998a6b40b1e38e8c6006cb0a)) $v66f6181bcb4cff4cd38fbc804a036db6->setType($v599dcce2998a6b40b1e38e8c6006cb0a);$v66f6181bcb4cff4cd38fbc804a036db6->setLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86);$v66f6181bcb4cff4cd38fbc804a036db6->setDomainId($v662cbf1253ac7d8750ed9190c52163e5);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_templates++;$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " .  $this->getLabel('label-has-been-created-m'));}elseif($v66f6181bcb4cff4cd38fbc804a036db6->getIsUpdated()) {$this->updated_templates++;$this->writeLog($this->getLabel('label-template') . " \"" . $vd5d3db1765287eef77d7927cc956f50a . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " .  $this->getLabel('label-has-been-updated-m'));}$v66f6181bcb4cff4cd38fbc804a036db6->commit();return $v66f6181bcb4cff4cd38fbc804a036db6;}protected function importRestriction(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('title') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('title') : null;$v851f5ac9941d720844d143ed9cfcf60a = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('prefix') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('prefix') : null;$v17f71d965fe9589ddbd11caf7182243e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-type') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-type') : null;$vce495ab8d79db0d37413d8e95b54e606 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-multiple') == 1 || $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('is-multiple') == "multiple";if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError($this->getLabel('label-cannot-create-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v519504d7d4beb745dac24ccfb6c1d7c9 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v17f71d965fe9589ddbd11caf7182243e, $vce495ab8d79db0d37413d8e95b54e606);$v94757cae63fd3e398c0811a976dd6bbe = $v519504d7d4beb745dac24ccfb6c1d7c9->getId();$ve2fa538867c3830a859a5b17ab24644b = false;$v228c63e369a5906eb7f0500a13729edc = false;if (!$vd5d3db1765287eef77d7927cc956f50a) $vd5d3db1765287eef77d7927cc956f50a = $v61ce6a78cb3c8547fed20990c92edfe3;if(baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v94757cae63fd3e398c0811a976dd6bbe)) {$v228c63e369a5906eb7f0500a13729edc = baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v94757cae63fd3e398c0811a976dd6bbe)->getId();if ($v228c63e369a5906eb7f0500a13729edc != $this->relations->getNewRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v228c63e369a5906eb7f0500a13729edc);}}if (!$v228c63e369a5906eb7f0500a13729edc) $v228c63e369a5906eb7f0500a13729edc = $this->relations->getNewRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if(!$v228c63e369a5906eb7f0500a13729edc) {$v228c63e369a5906eb7f0500a13729edc = baseRestriction::add($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a, $v94757cae63fd3e398c0811a976dd6bbe);$this->relations->setRestrictionIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $v228c63e369a5906eb7f0500a13729edc);$ve2fa538867c3830a859a5b17ab24644b = true;}$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v228c63e369a5906eb7f0500a13729edc);if (!$v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$this->reportError($this->getLabel('label-cannot-detect-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_restrictions++;$this->writeLog($this->getLabel('label-restriction') . " \"" . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") " . $this->getLabel('label-has-been-created-n'));}$vd05b6ed7d2345020440df396d6da7f73 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('field');foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v39b7b22d803b1a0270c9c6c6f8a3b4cb) {$v6adb6b0ad1941d569b23e089910c5e74 = $v39b7b22d803b1a0270c9c6c6f8a3b4cb->getAttribute('field-name');$v2741adf691b2acf0359a6a73234bc605 = $v39b7b22d803b1a0270c9c6c6f8a3b4cb->getAttribute('type-id');$v87306dd4235ed712ebc07fe169b76f83 = $this->relations->getNewTypeIdRelation($this->source_id, $v2741adf691b2acf0359a6a73234bc605);$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) {$this->reportError($this->getLabel('label-cannot-set-restriction-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\": " . $this->getLabel('label-cannot-detect-field'));continue;}$v06e3d36fa30cea095545139854ad1fb9->setRestrictionId($v228c63e369a5906eb7f0500a13729edc);$v06e3d36fa30cea095545139854ad1fb9->setIsUpdated();$this->writeLog($this->getLabel('label-restriction') . " \"" . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . "\" " . $this->getLabel('label-has-been-set-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\"");}return $v3dadfaeb46ec74762b37de11fea7605c;}protected function importReg(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$vd6fe1d0be6347b8ef2427fa629c04485 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('path') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('path') : null;$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('val') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('val') : null;$vd56f1805d22496cadf21ef1153ed9729 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('update') ? true : false;if (!strlen($vd6fe1d0be6347b8ef2427fa629c04485)) {$this->reportError($this->getLabel('label-cannot-create-registry-item-with-empty-path'));return false;}$ve2fa538867c3830a859a5b17ab24644b = false;$v0f81d52e06caaa4860887488d18271c7 = false;$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();if(!$vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485)){$vb1444fb0c07653567ad325aa25d4e37a->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$ve2fa538867c3830a859a5b17ab24644b = true;$v64274c99ceefb2aaeacf6761a0c22bb7 = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);}elseif ($vd56f1805d22496cadf21ef1153ed9729) {$vb1444fb0c07653567ad325aa25d4e37a->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v0f81d52e06caaa4860887488d18271c7 = true;$v64274c99ceefb2aaeacf6761a0c22bb7 = $vb1444fb0c07653567ad325aa25d4e37a->getKey($vd6fe1d0be6347b8ef2427fa629c04485);}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_registry_items++;$this->writeLog($this->getLabel('label-registry-item') . " \"" . $vd6fe1d0be6347b8ef2427fa629c04485 . "\" (" . $v64274c99ceefb2aaeacf6761a0c22bb7 . ") " . $this->getLabel('label-has-been-created-f'));}elseif ($v0f81d52e06caaa4860887488d18271c7) {$this->writeLog("Registry item \"" . $vd6fe1d0be6347b8ef2427fa629c04485 . "\" (" . $v64274c99ceefb2aaeacf6761a0c22bb7 . ") has been updated");}}protected function importTypeRelation(umiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, umiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a) {$v8328b28850bcb3400e7349ac3d5602c6 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('guide');$vd535f8615f1de2e299e22535183a9d22 = $v8328b28850bcb3400e7349ac3d5602c6->length ? $v8328b28850bcb3400e7349ac3d5602c6->item(0)->getAttribute('id') : false;$v051369818a8073bba5feeb0e957eb308 = $this->relations->getNewTypeIdRelation($this->source_id, $vd535f8615f1de2e299e22535183a9d22);if(!$v051369818a8073bba5feeb0e957eb308) return false;if($v06e3d36fa30cea095545139854ad1fb9->getGuideId() != $v051369818a8073bba5feeb0e957eb308) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v051369818a8073bba5feeb0e957eb308);$this->updated_relations++;$this->writeLog($this->getLabel('label-relation') . ': ' . $this->getLabel('label-datatype') . " (" . $v599dcce2998a6b40b1e38e8c6006cb0a->getName() . ") - " . $this->getLabel('label-field') . " (" . $v06e3d36fa30cea095545139854ad1fb9->getName() . ") - " . $this->getLabel('label-guide') . " ({$v051369818a8073bba5feeb0e957eb308}) " . $this->getLabel('label-has-been-updated-f'));$v06e3d36fa30cea095545139854ad1fb9->commit();}return true;}protected function importEntityRelation(umiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c,  $vf5e638cc78dd325906c1298a0c21fb6b) {$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v7b8b965ad4bca0e41ab51de7b31363a1 = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('object');$v8a835ad560df7fd10a6de48e2a41cab9 = array();foreach ($v7b8b965ad4bca0e41ab51de7b31363a1 as $vbe8f80182e0c983916da7338c2c1c040) {$vdfa97186b5b1022fcd7e8a1565ca0281 = $vbe8f80182e0c983916da7338c2c1c040->getAttribute('id');$v818ad5ef6588e140ecb9f81e810c028a = (int) $this->relations->getNewObjectIdRelation($this->source_id, $vdfa97186b5b1022fcd7e8a1565ca0281);if ($v818ad5ef6588e140ecb9f81e810c028a) $v8a835ad560df7fd10a6de48e2a41cab9[] = $v818ad5ef6588e140ecb9f81e810c028a;}$v83878c91171338902e0fe0fb97a8c47a = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('page');$va604734f6232fb47dbae6e45c3ea1267 = array();foreach ($v83878c91171338902e0fe0fb97a8c47a as $v235ec52392b77977539cf78b62e708d3) {$vbffcbc6014e374bbf5cdb7d4ae50793b = $v235ec52392b77977539cf78b62e708d3->getAttribute('id');$v90ebb72e4e25752c5cf4b97588aa65b8 = (int) $this->relations->getNewIdRelation($this->source_id, $vbffcbc6014e374bbf5cdb7d4ae50793b);if ($v90ebb72e4e25752c5cf4b97588aa65b8) $va604734f6232fb47dbae6e45c3ea1267[] = $v90ebb72e4e25752c5cf4b97588aa65b8;}$v0f81d52e06caaa4860887488d18271c7 = false;$v89111891eb7be9259794ada04dbf5856 = ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) ? "object" : "page";$vdffc4713b6bf326dc0d3e2805bc742fd = $vf5e638cc78dd325906c1298a0c21fb6b->getId();if (count($v8a835ad560df7fd10a6de48e2a41cab9)) {$v2063c1608d6e0baf80249c42e2be5804 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($v73f329f154a663bfda020aadcdd0b775);if(!is_array($v2063c1608d6e0baf80249c42e2be5804)) $v2063c1608d6e0baf80249c42e2be5804 = array($v2063c1608d6e0baf80249c42e2be5804);if(count(array_diff($v8a835ad560df7fd10a6de48e2a41cab9, $v2063c1608d6e0baf80249c42e2be5804))) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $v8a835ad560df7fd10a6de48e2a41cab9);$this->updated_relations++;$v0f81d52e06caaa4860887488d18271c7 = true;}}elseif (count($va604734f6232fb47dbae6e45c3ea1267)) {$v2063c1608d6e0baf80249c42e2be5804 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($v73f329f154a663bfda020aadcdd0b775);if(!is_array($v2063c1608d6e0baf80249c42e2be5804)) $v2063c1608d6e0baf80249c42e2be5804 = array($v2063c1608d6e0baf80249c42e2be5804);if(count(array_diff($va604734f6232fb47dbae6e45c3ea1267, $v2063c1608d6e0baf80249c42e2be5804))) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $va604734f6232fb47dbae6e45c3ea1267);$this->updated_relations++;$v0f81d52e06caaa4860887488d18271c7 = true;}}else {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, array());}if ($v0f81d52e06caaa4860887488d18271c7) {if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v73f329f154a663bfda020aadcdd0b775}) " . $this->getLabel('label-of-object') . " ({$vdffc4713b6bf326dc0d3e2805bc742fd}) " . $this->getLabel('label-have-been-updated'));}else {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v73f329f154a663bfda020aadcdd0b775}) " . $this->getLabel('label-of-object') . " ({$vdffc4713b6bf326dc0d3e2805bc742fd}) " . $this->getLabel('label-have-been-updated'));}}$vf5e638cc78dd325906c1298a0c21fb6b->commit();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) {umiObjectsCollection::getInstance()->unloadObject($vdffc4713b6bf326dc0d3e2805bc742fd);}else {umiHierarchy::getInstance()->unloadElement($vdffc4713b6bf326dc0d3e2805bc742fd);}return true;}protected function importRelation(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('type-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id') : null;$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;$v6adb6b0ad1941d569b23e089910c5e74 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-name') : null;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6) && !strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\":" . $this->getLabel('label-cannot-detect-entity'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = null;$vf5e638cc78dd325906c1298a0c21fb6b = null;if (!is_null($v5f6492d9717ccf1b8566bd4bc64110b6)) {$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);}elseif (!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\": " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$v6adb6b0ad1941d569b23e089910c5e74}\":" . $this->getLabel('label-cannot-detect-field'));return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObjectType) {return $this->importTypeRelation($v06e3d36fa30cea095545139854ad1fb9, $vcaf9b6b99962bf5c2264824231d7a40c, $vf5e638cc78dd325906c1298a0c21fb6b);}else {return $this->importEntityRelation($v06e3d36fa30cea095545139854ad1fb9, $vcaf9b6b99962bf5c2264824231d7a40c, $vf5e638cc78dd325906c1298a0c21fb6b);}}protected function importPermission(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;if (!strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-permission') . ": " . $this->getLabel('label-cannot-detect-entity'));return false;}$v41275a535677f79ff347e01bc530c176 = permissionsCollection::getInstance();$vf5e638cc78dd325906c1298a0c21fb6b = null;if(!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-permission') . ": " . $this->getLabel('label-cannot-detect-entity'));return false;}$vdffc4713b6bf326dc0d3e2805bc742fd = $vf5e638cc78dd325906c1298a0c21fb6b->getId();$vd95679752134a2d9eb61dbd7b91c4bcc = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('owner');foreach ($vd95679752134a2d9eb61dbd7b91c4bcc as $v72122ce96bfec66e2396d2e25225d70a) {$v00cf378d42d732f83e6e38e7a3d0d1bd = $v72122ce96bfec66e2396d2e25225d70a->getAttribute('id');$v5e7b19364b8de2dedd3aa48cf62706e3 = (int) $this->relations->getNewObjectIdRelation($this->source_id, $v00cf378d42d732f83e6e38e7a3d0d1bd);$vc9e9a848920877e76685b2e4e76de38d = $v72122ce96bfec66e2396d2e25225d70a->hasAttribute('level') ? $v72122ce96bfec66e2396d2e25225d70a->getAttribute('level') : null;if(!is_null($vc9e9a848920877e76685b2e4e76de38d)) {$v41275a535677f79ff347e01bc530c176->setElementPermissions($v5e7b19364b8de2dedd3aa48cf62706e3, $vdffc4713b6bf326dc0d3e2805bc742fd, $vc9e9a848920877e76685b2e4e76de38d);$ve2fa538867c3830a859a5b17ab24644b = true;$this->created_permissions++;}else {$vf5e638cc78dd325906c1298a0c21fb6b->setOwnerId($v5e7b19364b8de2dedd3aa48cf62706e3);$vf5e638cc78dd325906c1298a0c21fb6b->setIsUpdated();$vf5e638cc78dd325906c1298a0c21fb6b->commit();$this->writeLog($this->getLabel('label-owner-for-entity') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") ". $this->getLabel('label-has-been-updated-m'));$this->created_permissions++;}}$v6f8f57715090da2632453988d9a1501b = $vcaf9b6b99962bf5c2264824231d7a40c->getElementsByTagName('module');foreach ($v6f8f57715090da2632453988d9a1501b as $v22884db148f0ffb0d830ba431102b0b5) {$v854203cccade0bbe21be239a208aea49 = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('name');$vea9f6aca279138c58f705c8d4cb4b8ce = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('method');$vb394126a0e52e75f1e3d535d0fb0d33c = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('allow');if ($vea9f6aca279138c58f705c8d4cb4b8ce == '' || is_null($vea9f6aca279138c58f705c8d4cb4b8ce)) {if (!$v41275a535677f79ff347e01bc530c176->isAllowedModule($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49)) {$v41275a535677f79ff347e01bc530c176->setModulesPermissions($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49);$this->writeLog($this->getLabel('label-permissions-for') . " " . $this->getLabel('label-module') . " \"{$v854203cccade0bbe21be239a208aea49}\" " . $this->getLabel('label-of-object') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") " . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}else {if(!$v41275a535677f79ff347e01bc530c176->isAllowedMethod($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49, $vea9f6aca279138c58f705c8d4cb4b8ce)) {$v41275a535677f79ff347e01bc530c176->setModulesPermissions($vdffc4713b6bf326dc0d3e2805bc742fd, $v854203cccade0bbe21be239a208aea49, $vea9f6aca279138c58f705c8d4cb4b8ce);$this->writeLog($this->getLabel('label-permissions-for') . " " . $this->getLabel('label-module') . " \"{$v854203cccade0bbe21be239a208aea49}\" - " . $this->getLabel('label-method') . " \"{$vea9f6aca279138c58f705c8d4cb4b8ce}\" " . $this->getLabel('label-of-object') . " (" . $vdffc4713b6bf326dc0d3e2805bc742fd . ") " . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}}}protected function importOption(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$ve6cdc29ecb7e2f6d140e54f2dd369628 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('page-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('page-id') : null;$va9cecbe3552e2561ce80cf4fe36d259c = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('object-id') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('object-id') : null;$v6adb6b0ad1941d569b23e089910c5e74 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('field-name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('field-name') : null;if (!strlen($ve6cdc29ecb7e2f6d140e54f2dd369628) && !strlen($va9cecbe3552e2561ce80cf4fe36d259c)) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-entity'));return false;}$vf5e638cc78dd325906c1298a0c21fb6b = null;if(!is_null($ve6cdc29ecb7e2f6d140e54f2dd369628)) {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $ve6cdc29ecb7e2f6d140e54f2dd369628);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true);}elseif(!is_null($va9cecbe3552e2561ce80cf4fe36d259c)) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $va9cecbe3552e2561ce80cf4fe36d259c);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiObject) $v94757cae63fd3e398c0811a976dd6bbe = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v3aabf39f2d943fa886d86dcbbee4d910 = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId(self::translateName($v6adb6b0ad1941d569b23e089910c5e74), false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe)->getFieldId($v6adb6b0ad1941d569b23e089910c5e74, false);if (!$v3aabf39f2d943fa886d86dcbbee4d910) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$v6adb6b0ad1941d569b23e089910c5e74} " . $this->getLabel('label-cannot-detect-field'));return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);$v73f329f154a663bfda020aadcdd0b775 = $v06e3d36fa30cea095545139854ad1fb9->getName();$vd95679752134a2d9eb61dbd7b91c4bcc =  $this->parser->evaluate("option", $vcaf9b6b99962bf5c2264824231d7a40c);$vf09cc7ee3a9a93273f4b80601cafb00c = array();foreach ($vd95679752134a2d9eb61dbd7b91c4bcc as $vef3e30e070f70244fd6578d88a6b77ac) {if($vef3e30e070f70244fd6578d88a6b77ac->hasAttributes()) {$v736b91750e516139acc13c5eb6564f92 = $vef3e30e070f70244fd6578d88a6b77ac->attributes;if(!is_null($v736b91750e516139acc13c5eb6564f92)) {foreach ($v736b91750e516139acc13c5eb6564f92 as $v6a992d5529f459a44fee58c733255e86 => $vd2eb444e35c0a71f0a85df8194acb5b6) {if($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'object-id') {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$vaf31437ce61345f416579830a98c91e5) {$this->reportError('ошибка');continue;}$vb068931cc450442b63f5b3d276ea4297 = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}elseif($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'page-id') {$v1a63c8004d716c8b91f5b7af780555b9 = $this->relations->getNewIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$v1a63c8004d716c8b91f5b7af780555b9) {$this->reportError('ошибка');continue;}$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::getInstance()->getElement($v1a63c8004d716c8b91f5b7af780555b9, true, true)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}else {$v2063c1608d6e0baf80249c42e2be5804[$vd2eb444e35c0a71f0a85df8194acb5b6->name] = $vd2eb444e35c0a71f0a85df8194acb5b6->value;}}$vf09cc7ee3a9a93273f4b80601cafb00c[] = $v2063c1608d6e0baf80249c42e2be5804;}}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v73f329f154a663bfda020aadcdd0b775, $vf09cc7ee3a9a93273f4b80601cafb00c);$vf5e638cc78dd325906c1298a0c21fb6b->commit();}protected function importFile(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v435ed7e9f07f740abf511a62c00eef6e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v166d2a3630c4f97c6ea560cc078ce94f = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('hash') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('hash') : null;$v857d5dae818a37d6732ac1faff247168 = $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if(!($v857d5dae818a37d6732ac1faff247168)) {$this->reportError($this->getLabel('label-cannot-create-file-with-empty-path'));return false;}$v857d5dae818a37d6732ac1faff247168 = CURRENT_WORKING_DIR . $v857d5dae818a37d6732ac1faff247168;$va06276a5d4dfec1460f81219fda03a37 = dirname($v857d5dae818a37d6732ac1faff247168);if(!file_exists($va06276a5d4dfec1460f81219fda03a37)) mkdir($va06276a5d4dfec1460f81219fda03a37, 0777, true);$vba1383ce0ab1b09b605e4c7010356023 = $this->filesSource . $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;if (!file_exists($vba1383ce0ab1b09b605e4c7010356023)) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-does-not-exist'));return false;}if (copy($vba1383ce0ab1b09b605e4c7010356023, $v857d5dae818a37d6732ac1faff247168)) {$v18fbb70e19607c55d46df321d043feb2 = md5_file($v857d5dae818a37d6732ac1faff247168);if ($v166d2a3630c4f97c6ea560cc078ce94f != $v18fbb70e19607c55d46df321d043feb2) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-is-broken'));}else {if (defined("PHP_FILES_ACCESS_MODE") && strtolower(substr($v857d5dae818a37d6732ac1faff247168, -4, 4))==='.php') {chmod($v857d5dae818a37d6732ac1faff247168, PHP_FILES_ACCESS_MODE);}$this->copied_files++;$this->writeLog($this->getLabel('label-file') . " \"" . $v435ed7e9f07f740abf511a62c00eef6e . "\" (" . $v857d5dae818a37d6732ac1faff247168 . ") " . $this->getLabel('label-has-been-copied-m'));}}else $this->reportError($this->getLabel('label-cannot-copy-file') ." \"{$v435ed7e9f07f740abf511a62c00eef6e}\"");}protected function importDir(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$vd6fe1d0be6347b8ef2427fa629c04485 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('path') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('path') : null;if(is_null($vd6fe1d0be6347b8ef2427fa629c04485)) {$this->reportError($this->getLabel('label-cannot-create-folder-with-empty-path'));return false;}else {$vd6fe1d0be6347b8ef2427fa629c04485 = CURRENT_WORKING_DIR . $vcaf9b6b99962bf5c2264824231d7a40c->nodeValue;}if(!file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {mkdir($vd6fe1d0be6347b8ef2427fa629c04485, 0777, true);$this->created_dirs++;$this->writeLog($this->getLabel('label-folder') . " \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (" . $vd6fe1d0be6347b8ef2427fa629c04485 . ") " . $this->getLabel('label-has-been-created-f'));}}protected function importObject(DOMElement $vcaf9b6b99962bf5c2264824231d7a40c) {$v61ce6a78cb3c8547fed20990c92edfe3 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('id');if (!strlen($v61ce6a78cb3c8547fed20990c92edfe3)) {$this->reportError("Can't create object {$vb068931cc450442b63f5b3d276ea4297} with empty id");return false;}$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('guid') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('guid') : null;$vb068931cc450442b63f5b3d276ea4297 = $vcaf9b6b99962bf5c2264824231d7a40c->hasAttribute('name') ? $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') : null;$v5f6492d9717ccf1b8566bd4bc64110b6 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('type-id');$vdff819de3d610895b1bdf4168281488c = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('update-only') == '1';$v1945c9a2a5e2ba6133f1db6757a35fcb = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('locked');$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectsCollection::getInstance();$v953e1ee8066af1b7e55300750533ddc8 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$vaf31437ce61345f416579830a98c91e5 = false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) {$vaf31437ce61345f416579830a98c91e5 = $vdb6d9b451b818ccc9a449383f2f0c450->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($vaf31437ce61345f416579830a98c91e5 && $vaf31437ce61345f416579830a98c91e5 != $this->relations->getNewObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3)) {$this->relations->setObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $vaf31437ce61345f416579830a98c91e5);}}if (!$vaf31437ce61345f416579830a98c91e5) $vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3);if ($vaf31437ce61345f416579830a98c91e5 && $this->update_ignore) {$this->writeLog($this->getLabel('label-object') .  " \"" . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vaf31437ce61345f416579830a98c91e5) {if ($vdff819de3d610895b1bdf4168281488c) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) $vb068931cc450442b63f5b3d276ea4297 = $v61ce6a78cb3c8547fed20990c92edfe3;if (!strlen($v5f6492d9717ccf1b8566bd4bc64110b6)) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}): " . $this->getLabel('label-cannot-detect-type'));return false;}$v94757cae63fd3e398c0811a976dd6bbe = $this->relations->getNewTypeIdRelation($this->source_id, $v5f6492d9717ccf1b8566bd4bc64110b6);$v599dcce2998a6b40b1e38e8c6006cb0a = $v953e1ee8066af1b7e55300750533ddc8->getType($v94757cae63fd3e398c0811a976dd6bbe);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof umiObjectType) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v61ce6a78cb3c8547fed20990c92edfe3}): " . $this->getLabel('label-cannot-detect-type'). " #{$v5f6492d9717ccf1b8566bd4bc64110b6}");return false;}if ($this->demosite_mode) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof umiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!regedit::getInstance()->getVal("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) return false;}}}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("old_object_id", $v61ce6a78cb3c8547fed20990c92edfe3);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("type", $v599dcce2998a6b40b1e38e8c6006cb0a);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);$vaf31437ce61345f416579830a98c91e5 = $vdb6d9b451b818ccc9a449383f2f0c450->addObject($vb068931cc450442b63f5b3d276ea4297, $v94757cae63fd3e398c0811a976dd6bbe, ($v1945c9a2a5e2ba6133f1db6757a35fcb == 'locked' || $v1945c9a2a5e2ba6133f1db6757a35fcb == '1'));$this->relations->setObjectIdRelation($this->source_id, $v61ce6a78cb3c8547fed20990c92edfe3, $vaf31437ce61345f416579830a98c91e5);$ve2fa538867c3830a859a5b17ab24644b = true;}$va8cfde6331bd59eb2ac96f8911c4b666 = $vdb6d9b451b818ccc9a449383f2f0c450->getObject($vaf31437ce61345f416579830a98c91e5);if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof umiObject) return false;if (!is_null($v1e0ca5b1252f1f6b1e0ac91be7e7219e)) $va8cfde6331bd59eb2ac96f8911c4b666->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if (!$ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}if (!is_null($vb068931cc450442b63f5b3d276ea4297)) $va8cfde6331bd59eb2ac96f8911c4b666->setName($vb068931cc450442b63f5b3d276ea4297);$this->importPropValues($va8cfde6331bd59eb2ac96f8911c4b666, $vcaf9b6b99962bf5c2264824231d7a40c, $ve2fa538867c3830a859a5b17ab24644b);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_objects++;$this->writeLog($this->getLabel('label-object') . " \"" . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-created-m'));}elseif($va8cfde6331bd59eb2ac96f8911c4b666->getIsUpdated()) {$this->updated_objects++;$this->writeLog($this->getLabel('label-object') . " \"" . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . "\" (" . $v61ce6a78cb3c8547fed20990c92edfe3 . ") ". $this->getLabel('label-has-been-updated-m'));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnAddObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}else {$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("exchangeOnUpdateObject");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("source_id", $this->source_id);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("object", $va8cfde6331bd59eb2ac96f8911c4b666);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("object_info", $vcaf9b6b99962bf5c2264824231d7a40c);umiEventsController::getInstance()->callEvent($v161c9aaa4fe035e7b2f465bc59f3ab45);}$va8cfde6331bd59eb2ac96f8911c4b666->commit();$vdb6d9b451b818ccc9a449383f2f0c450->unloadObject($vaf31437ce61345f416579830a98c91e5);return $va8cfde6331bd59eb2ac96f8911c4b666;}protected function importPropValues(umiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, $vd08e820fd4eb48eede47aa5985d10cc8 = false) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("properties/group/property", $vcaf9b6b99962bf5c2264824231d7a40c);foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $v410e0a26c217dfabf8a5653e8f9e68ef) {try {$this->importPropValue($vf5e638cc78dd325906c1298a0c21fb6b, $v410e0a26c217dfabf8a5653e8f9e68ef, $vd08e820fd4eb48eede47aa5985d10cc8);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->writeLog("Can't set value #" . $vf5e638cc78dd325906c1298a0c21fb6b->getId() . "." . $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name') . ": " . $ve1671797c52e15f763380b45e841ec32->getMessage());}}}protected static function translateName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::convertAltName($vb068931cc450442b63f5b3d276ea4297, "_");$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);if(!strlen($vb068931cc450442b63f5b3d276ea4297)) $vb068931cc450442b63f5b3d276ea4297 = '_';$vb068931cc450442b63f5b3d276ea4297 = substr($vb068931cc450442b63f5b3d276ea4297, 0, 64);return $vb068931cc450442b63f5b3d276ea4297;}protected function importPropValue(umiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $vcaf9b6b99962bf5c2264824231d7a40c, $vd08e820fd4eb48eede47aa5985d10cc8 = false) {$v3a229433643cf8ea25f2a9b198ea70d8 = $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('name');$vb068931cc450442b63f5b3d276ea4297 = self::translateName($v3a229433643cf8ea25f2a9b198ea70d8);$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("value", $vcaf9b6b99962bf5c2264824231d7a40c);if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length && $vd08e820fd4eb48eede47aa5985d10cc8) {$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("default-value", $vcaf9b6b99962bf5c2264824231d7a40c);}if (!$v1a13105b7e4eb5fb2e7c9515ac06aa48->length) {if ($vd08e820fd4eb48eede47aa5985d10cc8) $this->reportError($this->getLabel('label-property') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" " . $this->getLabel('label-has-no-values'));return false;}$v67236e502346412a98a0bb965b7a59e6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0);$v94757cae63fd3e398c0811a976dd6bbe = ($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) ? $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId() : $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);$v3aabf39f2d943fa886d86dcbbee4d910 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb068931cc450442b63f5b3d276ea4297, false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v3aabf39f2d943fa886d86dcbbee4d910);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField && $vcaf9b6b99962bf5c2264824231d7a40c->getAttribute('allow-runtime-add') == '1')  {$v562feb4548b66febf02774b4f339552e = $vcaf9b6b99962bf5c2264824231d7a40c->parentNode;$vdb0f6f37ebeb6ea09489124345af2a45 = $this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $v562feb4548b66febf02774b4f339552e, false);if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof umiFieldsGroup) return false;$v06e3d36fa30cea095545139854ad1fb9 = $this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $vcaf9b6b99962bf5c2264824231d7a40c);($vf5e638cc78dd325906c1298a0c21fb6b instanceof umiHierarchyElement) ? $vf5e638cc78dd325906c1298a0c21fb6b->getObject()->update() : $vf5e638cc78dd325906c1298a0c21fb6b->update();}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof umiField) return false;switch($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case "optioned":    case "symlink":  {return false;}case "date": {$vd7e6d55ba379a13d08c25d15faf2a23b = intval($v67236e502346412a98a0bb965b7a59e6->getAttribute('unix-timestamp'));$v8059f160e1aa1f9d3921049ce93b00e1 = new umiDate();if ($vd7e6d55ba379a13d08c25d15faf2a23b) {$v8059f160e1aa1f9d3921049ce93b00e1->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}else {$v8059f160e1aa1f9d3921049ce93b00e1->setDateByString($v67236e502346412a98a0bb965b7a59e6->nodeValue);}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v8059f160e1aa1f9d3921049ce93b00e1);break;}case "price": {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v78a5eb43deef9a7b5b9ce157b9d52ac4 = str_replace(',', '.', $v78a5eb43deef9a7b5b9ce157b9d52ac4);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = floatval(preg_replace("/[^0-9.,]/", "", $v78a5eb43deef9a7b5b9ce157b9d52ac4));$v52e3817fff5250b5391ef85b1ce23bdb = $v67236e502346412a98a0bb965b7a59e6->hasAttribute('currency-code') ? $v67236e502346412a98a0bb965b7a59e6->getAttribute('currency-code') : $v67236e502346412a98a0bb965b7a59e6->getAttribute('currency_code');if (strlen($v52e3817fff5250b5391ef85b1ce23bdb) && $vfcaea7edd270964cc145ea48e4367d43) {$v1af0389838508d7016a9841eb6273962 = $vfcaea7edd270964cc145ea48e4367d43->getCurrency($v52e3817fff5250b5391ef85b1ce23bdb);if ($v1af0389838508d7016a9841eb6273962) {$result = $vfcaea7edd270964cc145ea48e4367d43->formatCurrencyPrice(array($v78a5eb43deef9a7b5b9ce157b9d52ac4), $vfcaea7edd270964cc145ea48e4367d43->getDefaultCurrency(), $v1af0389838508d7016a9841eb6273962);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $result[0];}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v78a5eb43deef9a7b5b9ce157b9d52ac4);break;}case "file":    case "img_file":    case "video_file":    case "swf_file": {if ($this->renameFiles) {$v9d22547e12eafcfadf56ff88b9d67f4d = false;$vf83cd85f6404a7018af0fcf071f35751 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($vb068931cc450442b63f5b3d276ea4297);if ($vf83cd85f6404a7018af0fcf071f35751 instanceof umiFile) $v9d22547e12eafcfadf56ff88b9d67f4d = $vf83cd85f6404a7018af0fcf071f35751->getFilePath();$vbf0e61d0f411b035bf846149824fe352 = ltrim(trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"), ".");$v435ed7e9f07f740abf511a62c00eef6e = basename($vbf0e61d0f411b035bf846149824fe352);$v736007832d2167baaae763fd3a3f3cf1    = dirname ($vbf0e61d0f411b035bf846149824fe352);$vabf77184f55403d75b9d51d79162a7ca = explode(".", $v435ed7e9f07f740abf511a62c00eef6e);$vabf77184f55403d75b9d51d79162a7ca = end($vabf77184f55403d75b9d51d79162a7ca);$vd70819bac4952f91adc9954c5b055aca = translit::convert(trim($vf5e638cc78dd325906c1298a0c21fb6b->getName(), "\r\n"));$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca;$ve2942a04780e223b215eb8b663cf5353 = 0;$v149603e6c03516362a8da23f624db945 = error_reporting(0);while(true) {if(!file_exists(CURRENT_WORKING_DIR.'/'.$vbf0e61d0f411b035bf846149824fe352)) {break(2);}else {if($v9d22547e12eafcfadf56ff88b9d67f4d) {$v46cd4eff50a3aca89f0fbc7ea6a79453 = CURRENT_WORKING_DIR . ltrim($v9d22547e12eafcfadf56ff88b9d67f4d, ".");if (file_exists($v46cd4eff50a3aca89f0fbc7ea6a79453)) unlink($v46cd4eff50a3aca89f0fbc7ea6a79453);}}if(!file_exists(CURRENT_WORKING_DIR.'/'.$v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e.'.'.$vabf77184f55403d75b9d51d79162a7ca)) {break;}$ve2942a04780e223b215eb8b663cf5353++;$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca . '_'.$ve2942a04780e223b215eb8b663cf5353;}$v435ed7e9f07f740abf511a62c00eef6e .= '.'.$vabf77184f55403d75b9d51d79162a7ca;rename(CURRENT_WORKING_DIR.'/'.$vbf0e61d0f411b035bf846149824fe352, CURRENT_WORKING_DIR.'/'.$v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e);error_reporting($v149603e6c03516362a8da23f624db945);$vbf0e61d0f411b035bf846149824fe352 = '.' . $v736007832d2167baaae763fd3a3f3cf1  . '/' .  $v435ed7e9f07f740abf511a62c00eef6e;$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $vbf0e61d0f411b035bf846149824fe352);}else {$v47826cacc65c665212b821e6ff80b9b0 = ltrim(trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"), ".");$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, "." . $v47826cacc65c665212b821e6ff80b9b0);}break;}case "relation": {if($this->auto_guide_creation) {if ($vb068931cc450442b63f5b3d276ea4297 == 'payment_status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v903931b3a9d25a70683f51ab9d363d2e = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->id);$v70a17ffa722a3985b86d30b034ad06d7->setPaymentStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}elseif ($vb068931cc450442b63f5b3d276ea4297 == 'status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43) {$v903931b3a9d25a70683f51ab9d363d2e = $v67236e502346412a98a0bb965b7a59e6->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->id);$vc8db1069270b4aad8a8d03a1d939bc26 = $v70a17ffa722a3985b86d30b034ad06d7->getOrderStatus();$vf48da84a2621e8cad36af3c0af958502 = $v70a17ffa722a3985b86d30b034ad06d7->getCodeByStatus($vc8db1069270b4aad8a8d03a1d939bc26);if (!in_array($vf48da84a2621e8cad36af3c0af958502, array('ready', 'canceled', 'rejected'))) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v70a17ffa722a3985b86d30b034ad06d7->setOrderStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}}else {$v691d502cfd0e0626cd3b058e5682ad1c = array();$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $v67236e502346412a98a0bb965b7a59e6->getElementsByTagName("item");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $ve795119eccc6565f098fca8454bad366) {$v691d502cfd0e0626cd3b058e5682ad1c[] = $ve795119eccc6565f098fca8454bad366->getAttribute('name');}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v691d502cfd0e0626cd3b058e5682ad1c);}}break;}case "tags": {$v1a13105b7e4eb5fb2e7c9515ac06aa48 =  $this->parser->evaluate("combined", $vcaf9b6b99962bf5c2264824231d7a40c);if ($v67236e502346412a98a0bb965b7a59e6 = $v1a13105b7e4eb5fb2e7c9515ac06aa48->item(0)) $vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"));break;}case "string":    case "text":    case "wysiwyg":    case "boolean":    case "counter":    case "float":    case "int": {if ($vb068931cc450442b63f5b3d276ea4297 == 'payment_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'modificator_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'rule_type_id' || $vb068931cc450442b63f5b3d276ea4297 == 'delivery_type_id') {$v7f7cfde5ec586119b48911a2c75851e5 = $this->relations->getNewTypeIdRelation($this->source_id, $v67236e502346412a98a0bb965b7a59e6->nodeValue);if ($v7f7cfde5ec586119b48911a2c75851e5) $vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v7f7cfde5ec586119b48911a2c75851e5);break;}}default: {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($v67236e502346412a98a0bb965b7a59e6->nodeValue, "\r\n"));break;}}}protected function importLangs() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/langs/lang");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importLang($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importObjects() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/objects/object");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importObject($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDomains() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/domains/domain");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDomain($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importTemplates() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/templates/template");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importTemplate($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importFiles() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/files/file");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importFile($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDirs() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/directories/directory");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importDir($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRelations () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/relations/relation");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importRelation($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRestrictions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/restrictions/restriction");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importRestriction($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importRegistry () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/registry/key");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importReg($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function setDefaultPermissions () {if(!count($this->imported_elements)) return;$vdb6d9b451b818ccc9a449383f2f0c450 = permissionsCollection::getInstance();foreach ($this->imported_elements as $v7057e8409c7c531a1a6e9ac3df4ed549) {$vdb6d9b451b818ccc9a449383f2f0c450->setDefaultPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);}}protected function importPermissions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/permissions/permission");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importPermission($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importOptions () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/options/entity");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importOption($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importDataTypes () {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/datatypes/datatype");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importFieldType($vcaf9b6b99962bf5c2264824231d7a40c);}}protected function importHierarchy() {$v1a13105b7e4eb5fb2e7c9515ac06aa48 = $this->parser->evaluate("/umidump/hierarchy/relation");foreach ($v1a13105b7e4eb5fb2e7c9515ac06aa48 as $vcaf9b6b99962bf5c2264824231d7a40c) {$this->importHierarchyRelation($vcaf9b6b99962bf5c2264824231d7a40c);}if($v1a13105b7e4eb5fb2e7c9515ac06aa48->length) {umiHierarchy::getInstance()->rebuildRelationNodes($this->destination_element_id);}}};?>